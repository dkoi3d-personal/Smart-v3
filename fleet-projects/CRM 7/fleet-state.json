{
  "version": "1.0",
  "projectId": "CRM 7",
  "timestamp": "2025-12-16T01:55:04.825Z",
  "fleetState": {
    "architecture": {
      "id": "5054e4be-ad8b-44cc-8a77-fd5948b8a7a5",
      "projectName": "CRM 7",
      "generatedAt": "2025-12-16T01:55:04.799Z",
      "overview": "This CRM system is designed as a modern, multi-tenant SaaS application built on Next.js 14 with App Router, leveraging server components for optimal performance and SEO while maintaining rich interactivity where needed. The architecture follows a clean separation between the presentation layer (React components), business logic (services), and data access (Prisma repositories), enabling testability and maintainability as the codebase scales to support 10,000+ contacts per organization.\n\nThe multi-tenant architecture uses Row-Level Security (RLS) at the PostgreSQL level combined with Prisma middleware to enforce organization isolation, ensuring complete data separation without the operational complexity of separate databases. Authentication flows through NextAuth.js with support for credentials and OAuth providers, while authorization is handled through a role-based access control system with four tiers (Admin, Manager, Sales Rep, Read-only) that integrates with both API routes and UI components.\n\nKey architectural decisions include: using React Query for server state management to handle complex caching scenarios in the CRM domain (contact lists, deal pipelines, activity feeds), implementing a JSONB-based custom fields system for extensibility without schema migrations, and adopting a soft-delete pattern across all entities to support GDPR compliance and data recovery requirements. The file storage abstraction supports both S3 and Cloudflare R2, allowing deployment flexibility.",
      "techStack": [
        {
          "category": "frontend",
          "name": "Next.js",
          "version": "14.2",
          "purpose": "React framework with App Router for server components, API routes, and optimized rendering"
        },
        {
          "category": "frontend",
          "name": "TypeScript",
          "version": "5.4",
          "purpose": "Strict type safety across frontend and backend code"
        },
        {
          "category": "frontend",
          "name": "React",
          "version": "18.3",
          "purpose": "UI component library with concurrent features"
        },
        {
          "category": "frontend",
          "name": "Tailwind CSS",
          "version": "3.4",
          "purpose": "Utility-first CSS framework for rapid UI development"
        },
        {
          "category": "frontend",
          "name": "shadcn/ui",
          "version": "latest",
          "purpose": "Accessible, customizable component primitives built on Radix UI"
        },
        {
          "category": "frontend",
          "name": "TanStack Query",
          "version": "5",
          "purpose": "Server state management with caching, background refetching, and optimistic updates"
        },
        {
          "category": "frontend",
          "name": "TanStack Table",
          "version": "8",
          "purpose": "Headless table library for contact lists, deal tables, and reports"
        },
        {
          "category": "frontend",
          "name": "React Hook Form",
          "version": "7",
          "purpose": "Performant form handling with Zod integration"
        },
        {
          "category": "frontend",
          "name": "Zod",
          "version": "3",
          "purpose": "Runtime schema validation for forms and API payloads"
        },
        {
          "category": "frontend",
          "name": "date-fns",
          "version": "3",
          "purpose": "Date manipulation for activity timelines and due dates"
        },
        {
          "category": "frontend",
          "name": "dnd-kit",
          "version": "6",
          "purpose": "Drag-and-drop for kanban pipeline board"
        },
        {
          "category": "database",
          "name": "PostgreSQL",
          "version": "15",
          "purpose": "Primary relational database with JSONB support and Row-Level Security"
        },
        {
          "category": "database",
          "name": "Prisma",
          "version": "5.10",
          "purpose": "Type-safe ORM with migrations, middleware, and query building"
        },
        {
          "category": "auth",
          "name": "NextAuth.js",
          "version": "5",
          "purpose": "Authentication with credentials, Google OAuth, and session management"
        },
        {
          "category": "auth",
          "name": "bcrypt",
          "version": "5",
          "purpose": "Password hashing for credential authentication"
        },
        {
          "category": "storage",
          "name": "AWS SDK v3",
          "version": "3",
          "purpose": "S3/R2 compatible file uploads with signed URLs"
        },
        {
          "category": "backend",
          "name": "node-cron",
          "version": "3",
          "purpose": "Background job scheduling for reminders and email sync"
        },
        {
          "category": "backend",
          "name": "xlsx",
          "version": "0.18",
          "purpose": "Excel file parsing and generation for import/export"
        },
        {
          "category": "backend",
          "name": "papaparse",
          "version": "5",
          "purpose": "CSV parsing for contact/company imports"
        },
        {
          "category": "backend",
          "name": "pdfmake",
          "version": "0.2",
          "purpose": "PDF generation for report exports"
        },
        {
          "category": "testing",
          "name": "Vitest",
          "version": "1",
          "purpose": "Fast unit and integration testing with TypeScript support"
        },
        {
          "category": "testing",
          "name": "React Testing Library",
          "version": "14",
          "purpose": "Component testing with accessibility focus"
        },
        {
          "category": "testing",
          "name": "MSW",
          "version": "2",
          "purpose": "API mocking for integration tests"
        },
        {
          "category": "devops",
          "name": "ESLint",
          "version": "8",
          "purpose": "Code linting with Next.js and TypeScript rules"
        },
        {
          "category": "devops",
          "name": "Prettier",
          "version": "3",
          "purpose": "Code formatting consistency"
        },
        {
          "category": "devops",
          "name": "Husky",
          "version": "9",
          "purpose": "Git hooks for pre-commit validation"
        }
      ],
      "folderStructure": "app/\n  (auth)/\n    login/\n      page.tsx\n    register/\n      page.tsx\n    forgot-password/\n      page.tsx\n    layout.tsx\n  (dashboard)/\n    page.tsx                    # Main dashboard with KPIs\n    contacts/\n      page.tsx                  # Contact list with search/filter\n      [id]/\n        page.tsx                # Contact detail view\n      new/\n        page.tsx                # Create contact form\n      import/\n        page.tsx                # CSV/Excel import wizard\n    companies/\n      page.tsx\n      [id]/\n        page.tsx\n      new/\n        page.tsx\n    deals/\n      page.tsx                  # Pipeline kanban view\n      [id]/\n        page.tsx\n      new/\n        page.tsx\n    tasks/\n      page.tsx                  # Task list and calendar view\n    reports/\n      page.tsx                  # Report builder and exports\n      [reportId]/\n        page.tsx\n    settings/\n      page.tsx\n      team/\n        page.tsx                # Team management\n      users/\n        page.tsx                # User management (admin)\n      pipelines/\n        page.tsx                # Pipeline stage customization\n      custom-fields/\n        page.tsx                # Custom field definitions\n      integrations/\n        page.tsx\n    layout.tsx                  # Dashboard shell with sidebar\n  api/\n    auth/\n      [...nextauth]/\n        route.ts\n    contacts/\n      route.ts                  # GET (list), POST (create)\n      [id]/\n        route.ts                # GET, PATCH, DELETE\n      import/\n        route.ts                # POST bulk import\n      export/\n        route.ts                # GET CSV/Excel export\n      merge/\n        route.ts                # POST merge duplicates\n    companies/\n      route.ts\n      [id]/\n        route.ts\n    deals/\n      route.ts\n      [id]/\n        route.ts\n        stage/\n          route.ts              # PATCH move stage\n    tasks/\n      route.ts\n      [id]/\n        route.ts\n    activities/\n      route.ts\n      [id]/\n        route.ts\n    users/\n      route.ts\n      [id]/\n        route.ts\n    teams/\n      route.ts\n      [id]/\n        route.ts\n    reports/\n      route.ts\n      [id]/\n        export/\n          route.ts              # PDF/Excel export\n    upload/\n      route.ts                  # Signed URL generation\n    webhooks/\n      route.ts\n  layout.tsx\n  globals.css\ncomponents/\n  ui/                           # shadcn/ui components\n    button.tsx\n    input.tsx\n    card.tsx\n    dialog.tsx\n    dropdown-menu.tsx\n    select.tsx\n    table.tsx\n    toast.tsx\n    avatar.tsx\n    badge.tsx\n    tabs.tsx\n    command.tsx                 # Command palette\n    calendar.tsx\n    popover.tsx\n    sheet.tsx\n    skeleton.tsx\n  layout/\n    sidebar.tsx\n    header.tsx\n    nav-item.tsx\n    user-menu.tsx\n    mobile-nav.tsx\n    breadcrumbs.tsx\n  contacts/\n    contact-card.tsx\n    contact-list.tsx\n    contact-form.tsx\n    contact-detail.tsx\n    contact-activity-timeline.tsx\n    contact-tags.tsx\n    duplicate-detector.tsx\n    merge-dialog.tsx\n  companies/\n    company-card.tsx\n    company-list.tsx\n    company-form.tsx\n    company-hierarchy.tsx\n    linked-contacts.tsx\n  deals/\n    pipeline-board.tsx\n    pipeline-column.tsx\n    deal-card.tsx\n    deal-form.tsx\n    deal-detail.tsx\n    stage-editor.tsx\n    win-loss-dialog.tsx\n  tasks/\n    task-list.tsx\n    task-card.tsx\n    task-form.tsx\n    task-calendar.tsx\n    reminder-badge.tsx\n  activities/\n    activity-list.tsx\n    activity-form.tsx\n    activity-type-icon.tsx\n  reports/\n    dashboard-kpis.tsx\n    pipeline-chart.tsx\n    conversion-funnel.tsx\n    report-builder.tsx\n    report-filters.tsx\n  shared/\n    data-table.tsx              # Reusable table with sorting/filtering\n    search-input.tsx\n    filter-bar.tsx\n    pagination.tsx\n    empty-state.tsx\n    loading-spinner.tsx\n    error-boundary.tsx\n    confirm-dialog.tsx\n    file-upload.tsx\n    custom-field-renderer.tsx\n    custom-field-input.tsx\n    entity-selector.tsx         # Contact/Company/Deal picker\n    tag-input.tsx\n    date-picker.tsx\n    currency-input.tsx\nlib/\n  db.ts                         # Prisma client singleton\n  auth.ts                       # NextAuth configuration\n  auth-options.ts               # Auth providers and callbacks\n  utils.ts                      # cn() and general utilities\n  constants.ts                  # App-wide constants\n  config.ts                     # Environment variable validation\n  validation/\n    contact.ts                  # Contact form schemas\n    company.ts\n    deal.ts\n    task.ts\n    user.ts\n    custom-field.ts\n  hooks/\n    use-contacts.ts             # Contact CRUD hooks\n    use-companies.ts\n    use-deals.ts\n    use-tasks.ts\n    use-activities.ts\n    use-users.ts\n    use-teams.ts\n    use-reports.ts\n    use-debounce.ts\n    use-local-storage.ts\n    use-media-query.ts\n    use-organization.ts         # Current org context\n    use-permissions.ts          # RBAC check hooks\nservices/\n  contacts/\n    contact-service.ts          # Business logic\n    contact-repository.ts       # Data access\n    duplicate-detection.ts      # Duplicate matching algorithm\n    contact-merge.ts            # Merge logic\n  companies/\n    company-service.ts\n    company-repository.ts\n    hierarchy-service.ts\n  deals/\n    deal-service.ts\n    deal-repository.ts\n    pipeline-service.ts\n    probability-calculator.ts\n  tasks/\n    task-service.ts\n    task-repository.ts\n    reminder-service.ts\n    recurrence-service.ts\n  activities/\n    activity-service.ts\n    activity-repository.ts\n    timeline-aggregator.ts\n  users/\n    user-service.ts\n    user-repository.ts\n    team-service.ts\n    assignment-service.ts       # Lead assignment rules\n  reports/\n    report-service.ts\n    kpi-calculator.ts\n    export-service.ts           # PDF/Excel generation\n  storage/\n    storage-service.ts          # S3/R2 abstraction\n    file-metadata-service.ts\n  import-export/\n    csv-parser.ts\n    excel-parser.ts\n    field-mapper.ts\n    import-validator.ts\n  audit/\n    audit-service.ts            # Audit log writing\n  custom-fields/\n    custom-field-service.ts\n    field-validator.ts\ntypes/\n  index.ts                      # Re-exports\n  contact.ts\n  company.ts\n  deal.ts\n  task.ts\n  activity.ts\n  user.ts\n  team.ts\n  organization.ts\n  pipeline.ts\n  custom-field.ts\n  report.ts\n  api.ts                        # API request/response types\n  auth.ts                       # Session and auth types\nmiddleware.ts                   # Auth and tenant middleware\nprisma/\n  schema.prisma\n  migrations/\n  seed.ts                       # Development seed data\npublic/\n  images/\n  icons/\ntests/\n  setup.ts\n  utils.tsx                     # Test utilities and renders\n  mocks/\n    handlers.ts                 # MSW handlers\n    data.ts                     # Mock data factories\n  unit/\n  integration/",
      "conventions": {
        "naming": {
          "components": "PascalCase (e.g., ContactCard.tsx, PipelineBoard.tsx)",
          "hooks": "camelCase with 'use' prefix (e.g., useContacts, useDebounce)",
          "utilities": "camelCase (e.g., formatCurrency, calculateProbability)",
          "types": "PascalCase, no I prefix for interfaces (e.g., Contact, DealStage)",
          "services": "PascalCase with Service/Repository suffix (e.g., ContactService)",
          "files": "kebab-case for utilities and hooks, PascalCase for components",
          "apiRoutes": "lowercase with hyphens matching URL path",
          "constants": "SCREAMING_SNAKE_CASE for true constants, camelCase for config objects",
          "database": "snake_case for columns, PascalCase for Prisma models"
        },
        "fileOrganization": "Feature-based organization in app/ with route groups for auth and dashboard layouts. Shared UI primitives in components/ui/, domain-specific components in components/{domain}/. Business logic isolated in services/ with repository pattern separating data access. Type definitions colocated by domain in types/. Validation schemas in lib/validation/ using Zod.",
        "patterns": [
          "Repository pattern - Data access isolated in *-repository.ts files, services call repositories",
          "Service layer - Business logic in *-service.ts, API routes call services",
          "Provider pattern - Auth, Query, Theme providers wrap app in layout.tsx",
          "Custom hooks - Data fetching wrapped in domain-specific hooks using React Query",
          "Compound components - Complex UI like DataTable uses composition pattern",
          "Render props - Flexible rendering for entity selectors and custom field renderers",
          "Factory pattern - Query key factories for consistent cache management",
          "Strategy pattern - Pluggable storage backends (S3/R2), export formats (PDF/Excel)",
          "Middleware chain - Prisma middleware for soft deletes, audit logging, tenant isolation"
        ],
        "errorHandling": "API routes return consistent error responses with status codes and messages. Client uses React Query error states with toast notifications via shadcn/ui Toaster. Error boundaries at route segment level catch render errors. Zod validation errors mapped to form field errors via React Hook Form. Network errors trigger retry with exponential backoff. Critical errors logged to console (production: external service).",
        "stateManagement": "React Context for auth session and current organization context only. All server state (contacts, deals, etc.) managed by React Query with aggressive caching. Form state handled by React Hook Form with Zod resolvers. UI state (modals, sidebar) uses local component state or URL search params. No global state library needed - composition of hooks provides equivalent functionality.",
        "styling": "Tailwind CSS utility classes as primary styling method. shadcn/ui components as base, customized via Tailwind config theme extension. Design tokens defined in tailwind.config.ts (colors, spacing, typography). Component variants handled by class-variance-authority (cva). Dark mode support via Tailwind dark: prefix with class strategy. No CSS modules or styled-components."
      },
      "components": [],
      "dataModels": [
        {
          "id": "model-organization",
          "name": "Organization",
          "description": "Multi-tenant root entity representing a customer organization/account",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Organization name"
            },
            {
              "name": "slug",
              "type": "string",
              "required": true,
              "description": "URL-friendly unique identifier"
            },
            {
              "name": "domain",
              "type": "string",
              "required": false,
              "description": "Primary email domain for SSO"
            },
            {
              "name": "logo",
              "type": "string",
              "required": false,
              "description": "Logo image URL"
            },
            {
              "name": "settings",
              "type": "json",
              "required": false,
              "description": "Organization-level settings (JSONB)"
            },
            {
              "name": "billingEmail",
              "type": "string",
              "required": false,
              "description": "Billing contact email"
            },
            {
              "name": "plan",
              "type": "string",
              "required": true,
              "description": "Subscription plan tier"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "User",
              "type": "one-to-many",
              "description": "Organization has many users"
            },
            {
              "targetModel": "Team",
              "type": "one-to-many",
              "description": "Organization has many teams"
            },
            {
              "targetModel": "Contact",
              "type": "one-to-many",
              "description": "Organization has many contacts"
            },
            {
              "targetModel": "Company",
              "type": "one-to-many",
              "description": "Organization has many companies"
            },
            {
              "targetModel": "Deal",
              "type": "one-to-many",
              "description": "Organization has many deals"
            },
            {
              "targetModel": "Pipeline",
              "type": "one-to-many",
              "description": "Organization has many pipelines"
            },
            {
              "targetModel": "CustomFieldDefinition",
              "type": "one-to-many",
              "description": "Organization has many custom field definitions"
            },
            {
              "targetModel": "Tag",
              "type": "one-to-many",
              "description": "Organization has many tags"
            }
          ]
        },
        {
          "id": "model-user",
          "name": "User",
          "description": "System user who can access the CRM",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "email",
              "type": "string",
              "required": true,
              "description": "User email address (unique per org)"
            },
            {
              "name": "emailVerified",
              "type": "Date",
              "required": false,
              "description": "Email verification timestamp"
            },
            {
              "name": "passwordHash",
              "type": "string",
              "required": false,
              "description": "Hashed password (null for OAuth users)"
            },
            {
              "name": "firstName",
              "type": "string",
              "required": true,
              "description": "First name"
            },
            {
              "name": "lastName",
              "type": "string",
              "required": true,
              "description": "Last name"
            },
            {
              "name": "avatar",
              "type": "string",
              "required": false,
              "description": "Profile picture URL"
            },
            {
              "name": "phone",
              "type": "string",
              "required": false,
              "description": "Phone number"
            },
            {
              "name": "role",
              "type": "enum",
              "required": true,
              "description": "Role: ADMIN, MANAGER, SALES_REP, READ_ONLY"
            },
            {
              "name": "timezone",
              "type": "string",
              "required": false,
              "description": "User timezone preference"
            },
            {
              "name": "locale",
              "type": "string",
              "required": false,
              "description": "Language/locale preference"
            },
            {
              "name": "settings",
              "type": "json",
              "required": false,
              "description": "User preferences (JSONB)"
            },
            {
              "name": "lastLoginAt",
              "type": "Date",
              "required": false,
              "description": "Last login timestamp"
            },
            {
              "name": "isActive",
              "type": "boolean",
              "required": true,
              "description": "Whether user can log in"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "User belongs to one organization"
            },
            {
              "targetModel": "Team",
              "type": "many-to-many",
              "description": "User can belong to many teams"
            },
            {
              "targetModel": "Account",
              "type": "one-to-many",
              "description": "User can have many OAuth accounts"
            },
            {
              "targetModel": "Session",
              "type": "one-to-many",
              "description": "User can have many sessions"
            },
            {
              "targetModel": "Contact",
              "type": "one-to-many",
              "description": "User owns many contacts"
            },
            {
              "targetModel": "Deal",
              "type": "one-to-many",
              "description": "User owns many deals"
            },
            {
              "targetModel": "Task",
              "type": "one-to-many",
              "description": "User assigned many tasks"
            },
            {
              "targetModel": "Activity",
              "type": "one-to-many",
              "description": "User performed many activities"
            }
          ]
        },
        {
          "id": "model-account",
          "name": "Account",
          "description": "OAuth provider account linked to a user (NextAuth.js)",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User"
            },
            {
              "name": "type",
              "type": "string",
              "required": true,
              "description": "Account type (oauth, credentials)"
            },
            {
              "name": "provider",
              "type": "string",
              "required": true,
              "description": "OAuth provider name"
            },
            {
              "name": "providerAccountId",
              "type": "string",
              "required": true,
              "description": "Provider's account ID"
            },
            {
              "name": "refreshToken",
              "type": "string",
              "required": false,
              "description": "OAuth refresh token"
            },
            {
              "name": "accessToken",
              "type": "string",
              "required": false,
              "description": "OAuth access token"
            },
            {
              "name": "expiresAt",
              "type": "number",
              "required": false,
              "description": "Token expiration timestamp"
            },
            {
              "name": "tokenType",
              "type": "string",
              "required": false,
              "description": "Token type"
            },
            {
              "name": "scope",
              "type": "string",
              "required": false,
              "description": "OAuth scopes granted"
            },
            {
              "name": "idToken",
              "type": "string",
              "required": false,
              "description": "OAuth ID token"
            },
            {
              "name": "sessionState",
              "type": "string",
              "required": false,
              "description": "Session state"
            }
          ],
          "relationships": [
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Account belongs to one user"
            }
          ]
        },
        {
          "id": "model-session",
          "name": "Session",
          "description": "User session for authentication (NextAuth.js)",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User"
            },
            {
              "name": "sessionToken",
              "type": "string",
              "required": true,
              "description": "Unique session token"
            },
            {
              "name": "expires",
              "type": "Date",
              "required": true,
              "description": "Session expiration timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Session belongs to one user"
            }
          ]
        },
        {
          "id": "model-verification-token",
          "name": "VerificationToken",
          "description": "Token for email verification and password reset (NextAuth.js)",
          "fields": [
            {
              "name": "identifier",
              "type": "string",
              "required": true,
              "description": "Email or other identifier"
            },
            {
              "name": "token",
              "type": "string",
              "required": true,
              "description": "Unique verification token"
            },
            {
              "name": "expires",
              "type": "Date",
              "required": true,
              "description": "Token expiration timestamp"
            }
          ],
          "relationships": []
        },
        {
          "id": "model-team",
          "name": "Team",
          "description": "Team/group of users within an organization",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Team name"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Team description"
            },
            {
              "name": "parentTeamId",
              "type": "string",
              "required": false,
              "description": "Foreign key to parent Team (hierarchy)"
            },
            {
              "name": "leaderId",
              "type": "string",
              "required": false,
              "description": "Foreign key to User (team leader)"
            },
            {
              "name": "territory",
              "type": "string",
              "required": false,
              "description": "Geographic territory assignment"
            },
            {
              "name": "settings",
              "type": "json",
              "required": false,
              "description": "Team-specific settings (JSONB)"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Team belongs to one organization"
            },
            {
              "targetModel": "Team",
              "type": "many-to-one",
              "description": "Team can have a parent team"
            },
            {
              "targetModel": "Team",
              "type": "one-to-many",
              "description": "Team can have child teams"
            },
            {
              "targetModel": "User",
              "type": "many-to-many",
              "description": "Team has many members"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Team has one leader"
            },
            {
              "targetModel": "Pipeline",
              "type": "one-to-many",
              "description": "Team can have custom pipelines"
            }
          ]
        },
        {
          "id": "model-team-membership",
          "name": "TeamMembership",
          "description": "Junction table for User-Team many-to-many relationship",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User"
            },
            {
              "name": "teamId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Team"
            },
            {
              "name": "role",
              "type": "enum",
              "required": true,
              "description": "Role within team: MEMBER, LEAD"
            },
            {
              "name": "joinedAt",
              "type": "Date",
              "required": true,
              "description": "When user joined team"
            }
          ],
          "relationships": [
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Membership belongs to one user"
            },
            {
              "targetModel": "Team",
              "type": "many-to-one",
              "description": "Membership belongs to one team"
            }
          ]
        },
        {
          "id": "model-contact",
          "name": "Contact",
          "description": "Individual person/contact in the CRM",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "ownerId",
              "type": "string",
              "required": false,
              "description": "Foreign key to User (owner)"
            },
            {
              "name": "firstName",
              "type": "string",
              "required": true,
              "description": "First name"
            },
            {
              "name": "lastName",
              "type": "string",
              "required": false,
              "description": "Last name"
            },
            {
              "name": "email",
              "type": "string",
              "required": false,
              "description": "Primary email address"
            },
            {
              "name": "secondaryEmail",
              "type": "string",
              "required": false,
              "description": "Secondary email address"
            },
            {
              "name": "phone",
              "type": "string",
              "required": false,
              "description": "Primary phone number"
            },
            {
              "name": "mobilePhone",
              "type": "string",
              "required": false,
              "description": "Mobile phone number"
            },
            {
              "name": "jobTitle",
              "type": "string",
              "required": false,
              "description": "Job title/position"
            },
            {
              "name": "department",
              "type": "string",
              "required": false,
              "description": "Department within company"
            },
            {
              "name": "avatar",
              "type": "string",
              "required": false,
              "description": "Profile picture URL"
            },
            {
              "name": "linkedinUrl",
              "type": "string",
              "required": false,
              "description": "LinkedIn profile URL"
            },
            {
              "name": "twitterUrl",
              "type": "string",
              "required": false,
              "description": "Twitter/X profile URL"
            },
            {
              "name": "address",
              "type": "json",
              "required": false,
              "description": "Address object (street, city, state, zip, country)"
            },
            {
              "name": "source",
              "type": "string",
              "required": false,
              "description": "Lead source (website, referral, etc.)"
            },
            {
              "name": "status",
              "type": "enum",
              "required": true,
              "description": "Status: ACTIVE, INACTIVE, UNSUBSCRIBED"
            },
            {
              "name": "customFields",
              "type": "json",
              "required": false,
              "description": "Custom field values (JSONB)"
            },
            {
              "name": "lastContactedAt",
              "type": "Date",
              "required": false,
              "description": "Last interaction timestamp"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Contact belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Contact owned by one user"
            },
            {
              "targetModel": "Company",
              "type": "many-to-many",
              "description": "Contact can work at many companies"
            },
            {
              "targetModel": "Deal",
              "type": "many-to-many",
              "description": "Contact can be associated with many deals"
            },
            {
              "targetModel": "Tag",
              "type": "many-to-many",
              "description": "Contact can have many tags"
            },
            {
              "targetModel": "Activity",
              "type": "one-to-many",
              "description": "Contact has many activities"
            },
            {
              "targetModel": "Task",
              "type": "one-to-many",
              "description": "Contact has many tasks"
            },
            {
              "targetModel": "Note",
              "type": "one-to-many",
              "description": "Contact has many notes"
            },
            {
              "targetModel": "File",
              "type": "one-to-many",
              "description": "Contact has many files"
            }
          ]
        },
        {
          "id": "model-company",
          "name": "Company",
          "description": "Business/company entity in the CRM",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "ownerId",
              "type": "string",
              "required": false,
              "description": "Foreign key to User (owner)"
            },
            {
              "name": "parentCompanyId",
              "type": "string",
              "required": false,
              "description": "Foreign key to parent Company (hierarchy)"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Company name"
            },
            {
              "name": "domain",
              "type": "string",
              "required": false,
              "description": "Company website domain"
            },
            {
              "name": "website",
              "type": "string",
              "required": false,
              "description": "Full website URL"
            },
            {
              "name": "phone",
              "type": "string",
              "required": false,
              "description": "Main phone number"
            },
            {
              "name": "email",
              "type": "string",
              "required": false,
              "description": "Main contact email"
            },
            {
              "name": "logo",
              "type": "string",
              "required": false,
              "description": "Company logo URL"
            },
            {
              "name": "industry",
              "type": "string",
              "required": false,
              "description": "Industry classification"
            },
            {
              "name": "employeeCount",
              "type": "enum",
              "required": false,
              "description": "Employee range: 1-10, 11-50, 51-200, 201-500, 501-1000, 1001+"
            },
            {
              "name": "annualRevenue",
              "type": "number",
              "required": false,
              "description": "Estimated annual revenue"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Company description"
            },
            {
              "name": "linkedinUrl",
              "type": "string",
              "required": false,
              "description": "LinkedIn company page URL"
            },
            {
              "name": "address",
              "type": "json",
              "required": false,
              "description": "Headquarters address (street, city, state, zip, country)"
            },
            {
              "name": "billingAddress",
              "type": "json",
              "required": false,
              "description": "Billing address"
            },
            {
              "name": "customFields",
              "type": "json",
              "required": false,
              "description": "Custom field values (JSONB)"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Company belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Company owned by one user"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Company can have parent company"
            },
            {
              "targetModel": "Company",
              "type": "one-to-many",
              "description": "Company can have child companies"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-many",
              "description": "Company has many contacts"
            },
            {
              "targetModel": "Deal",
              "type": "one-to-many",
              "description": "Company has many deals"
            },
            {
              "targetModel": "Tag",
              "type": "many-to-many",
              "description": "Company can have many tags"
            },
            {
              "targetModel": "Activity",
              "type": "one-to-many",
              "description": "Company has many activities"
            },
            {
              "targetModel": "Task",
              "type": "one-to-many",
              "description": "Company has many tasks"
            },
            {
              "targetModel": "Note",
              "type": "one-to-many",
              "description": "Company has many notes"
            },
            {
              "targetModel": "File",
              "type": "one-to-many",
              "description": "Company has many files"
            }
          ]
        },
        {
          "id": "model-contact-company",
          "name": "ContactCompany",
          "description": "Junction table for Contact-Company relationship with role metadata",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "contactId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Contact"
            },
            {
              "name": "companyId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Company"
            },
            {
              "name": "jobTitle",
              "type": "string",
              "required": false,
              "description": "Job title at this company"
            },
            {
              "name": "isPrimary",
              "type": "boolean",
              "required": true,
              "description": "Is this the primary company"
            },
            {
              "name": "startDate",
              "type": "Date",
              "required": false,
              "description": "Employment start date"
            },
            {
              "name": "endDate",
              "type": "Date",
              "required": false,
              "description": "Employment end date"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "Belongs to one contact"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Belongs to one company"
            }
          ]
        },
        {
          "id": "model-pipeline",
          "name": "Pipeline",
          "description": "Sales pipeline with customizable stages",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "teamId",
              "type": "string",
              "required": false,
              "description": "Foreign key to Team (team-specific pipeline)"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Pipeline name"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Pipeline description"
            },
            {
              "name": "isDefault",
              "type": "boolean",
              "required": true,
              "description": "Is default pipeline for org"
            },
            {
              "name": "isActive",
              "type": "boolean",
              "required": true,
              "description": "Is pipeline active"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Pipeline belongs to one organization"
            },
            {
              "targetModel": "Team",
              "type": "many-to-one",
              "description": "Pipeline can belong to one team"
            },
            {
              "targetModel": "PipelineStage",
              "type": "one-to-many",
              "description": "Pipeline has many stages"
            },
            {
              "targetModel": "Deal",
              "type": "one-to-many",
              "description": "Pipeline has many deals"
            }
          ]
        },
        {
          "id": "model-pipeline-stage",
          "name": "PipelineStage",
          "description": "Stage within a sales pipeline",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "pipelineId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Pipeline"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Stage name"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Stage description"
            },
            {
              "name": "position",
              "type": "number",
              "required": true,
              "description": "Order position in pipeline"
            },
            {
              "name": "probability",
              "type": "number",
              "required": true,
              "description": "Win probability percentage (0-100)"
            },
            {
              "name": "color",
              "type": "string",
              "required": false,
              "description": "Display color for stage"
            },
            {
              "name": "stageType",
              "type": "enum",
              "required": true,
              "description": "Type: OPEN, WON, LOST"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Pipeline",
              "type": "many-to-one",
              "description": "Stage belongs to one pipeline"
            },
            {
              "targetModel": "Deal",
              "type": "one-to-many",
              "description": "Stage has many deals"
            }
          ]
        },
        {
          "id": "model-deal",
          "name": "Deal",
          "description": "Sales opportunity/deal in the pipeline",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "pipelineId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Pipeline"
            },
            {
              "name": "stageId",
              "type": "string",
              "required": true,
              "description": "Foreign key to PipelineStage"
            },
            {
              "name": "ownerId",
              "type": "string",
              "required": false,
              "description": "Foreign key to User (owner)"
            },
            {
              "name": "companyId",
              "type": "string",
              "required": false,
              "description": "Foreign key to Company"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Deal name/title"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Deal description"
            },
            {
              "name": "value",
              "type": "number",
              "required": false,
              "description": "Deal value/amount"
            },
            {
              "name": "currency",
              "type": "string",
              "required": true,
              "description": "Currency code (USD, EUR, etc.)"
            },
            {
              "name": "probability",
              "type": "number",
              "required": false,
              "description": "Custom win probability override"
            },
            {
              "name": "expectedCloseDate",
              "type": "Date",
              "required": false,
              "description": "Expected close date"
            },
            {
              "name": "actualCloseDate",
              "type": "Date",
              "required": false,
              "description": "Actual close date"
            },
            {
              "name": "lossReason",
              "type": "string",
              "required": false,
              "description": "Reason for loss if lost"
            },
            {
              "name": "winReason",
              "type": "string",
              "required": false,
              "description": "Reason for win if won"
            },
            {
              "name": "source",
              "type": "string",
              "required": false,
              "description": "Deal source/origin"
            },
            {
              "name": "priority",
              "type": "enum",
              "required": false,
              "description": "Priority: LOW, MEDIUM, HIGH"
            },
            {
              "name": "customFields",
              "type": "json",
              "required": false,
              "description": "Custom field values (JSONB)"
            },
            {
              "name": "stageEnteredAt",
              "type": "Date",
              "required": true,
              "description": "When deal entered current stage"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Deal belongs to one organization"
            },
            {
              "targetModel": "Pipeline",
              "type": "many-to-one",
              "description": "Deal belongs to one pipeline"
            },
            {
              "targetModel": "PipelineStage",
              "type": "many-to-one",
              "description": "Deal at one stage"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Deal owned by one user"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Deal associated with one company"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-many",
              "description": "Deal can have many contacts"
            },
            {
              "targetModel": "Tag",
              "type": "many-to-many",
              "description": "Deal can have many tags"
            },
            {
              "targetModel": "Activity",
              "type": "one-to-many",
              "description": "Deal has many activities"
            },
            {
              "targetModel": "Task",
              "type": "one-to-many",
              "description": "Deal has many tasks"
            },
            {
              "targetModel": "Note",
              "type": "one-to-many",
              "description": "Deal has many notes"
            },
            {
              "targetModel": "File",
              "type": "one-to-many",
              "description": "Deal has many files"
            },
            {
              "targetModel": "DealStageHistory",
              "type": "one-to-many",
              "description": "Deal has stage transition history"
            }
          ]
        },
        {
          "id": "model-deal-contact",
          "name": "DealContact",
          "description": "Junction table for Deal-Contact relationship with role",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "dealId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Deal"
            },
            {
              "name": "contactId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Contact"
            },
            {
              "name": "role",
              "type": "string",
              "required": false,
              "description": "Contact's role in deal (Decision Maker, Influencer, etc.)"
            },
            {
              "name": "isPrimary",
              "type": "boolean",
              "required": true,
              "description": "Is primary contact for deal"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "Belongs to one deal"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "Belongs to one contact"
            }
          ]
        },
        {
          "id": "model-deal-stage-history",
          "name": "DealStageHistory",
          "description": "History of stage transitions for a deal",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "dealId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Deal"
            },
            {
              "name": "fromStageId",
              "type": "string",
              "required": false,
              "description": "Foreign key to previous PipelineStage"
            },
            {
              "name": "toStageId",
              "type": "string",
              "required": true,
              "description": "Foreign key to new PipelineStage"
            },
            {
              "name": "changedById",
              "type": "string",
              "required": true,
              "description": "Foreign key to User who made change"
            },
            {
              "name": "duration",
              "type": "number",
              "required": false,
              "description": "Days spent in previous stage"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Transition timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "Belongs to one deal"
            },
            {
              "targetModel": "PipelineStage",
              "type": "many-to-one",
              "description": "Reference to from stage"
            },
            {
              "targetModel": "PipelineStage",
              "type": "many-to-one",
              "description": "Reference to to stage"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Changed by one user"
            }
          ]
        },
        {
          "id": "model-activity",
          "name": "Activity",
          "description": "Logged activity/interaction (call, email, meeting, etc.)",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User who performed activity"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: CALL, EMAIL, MEETING, DEMO, NOTE, OTHER"
            },
            {
              "name": "subject",
              "type": "string",
              "required": true,
              "description": "Activity subject/title"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Activity description/notes"
            },
            {
              "name": "outcome",
              "type": "string",
              "required": false,
              "description": "Activity outcome"
            },
            {
              "name": "duration",
              "type": "number",
              "required": false,
              "description": "Duration in minutes"
            },
            {
              "name": "occurredAt",
              "type": "Date",
              "required": true,
              "description": "When activity occurred"
            },
            {
              "name": "subjectType",
              "type": "enum",
              "required": true,
              "description": "Polymorphic type: CONTACT, COMPANY, DEAL"
            },
            {
              "name": "subjectId",
              "type": "string",
              "required": true,
              "description": "Polymorphic ID to entity"
            },
            {
              "name": "metadata",
              "type": "json",
              "required": false,
              "description": "Additional metadata (JSONB)"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Activity belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Activity performed by one user"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "Activity can be linked to contact (polymorphic)"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Activity can be linked to company (polymorphic)"
            },
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "Activity can be linked to deal (polymorphic)"
            }
          ]
        },
        {
          "id": "model-task",
          "name": "Task",
          "description": "Task/to-do item linked to CRM entities",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "assigneeId",
              "type": "string",
              "required": false,
              "description": "Foreign key to User (assignee)"
            },
            {
              "name": "createdById",
              "type": "string",
              "required": true,
              "description": "Foreign key to User (creator)"
            },
            {
              "name": "title",
              "type": "string",
              "required": true,
              "description": "Task title"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Task description"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: CALL, EMAIL, MEETING, FOLLOW_UP, DEMO, OTHER"
            },
            {
              "name": "priority",
              "type": "enum",
              "required": true,
              "description": "Priority: LOW, MEDIUM, HIGH, URGENT"
            },
            {
              "name": "status",
              "type": "enum",
              "required": true,
              "description": "Status: PENDING, IN_PROGRESS, COMPLETED, CANCELLED"
            },
            {
              "name": "dueDate",
              "type": "Date",
              "required": false,
              "description": "Due date"
            },
            {
              "name": "dueTime",
              "type": "string",
              "required": false,
              "description": "Due time (HH:MM format)"
            },
            {
              "name": "reminderAt",
              "type": "Date",
              "required": false,
              "description": "Reminder datetime"
            },
            {
              "name": "completedAt",
              "type": "Date",
              "required": false,
              "description": "Completion timestamp"
            },
            {
              "name": "isRecurring",
              "type": "boolean",
              "required": true,
              "description": "Is recurring task"
            },
            {
              "name": "recurrenceRule",
              "type": "string",
              "required": false,
              "description": "RRULE for recurrence"
            },
            {
              "name": "subjectType",
              "type": "enum",
              "required": false,
              "description": "Polymorphic type: CONTACT, COMPANY, DEAL"
            },
            {
              "name": "subjectId",
              "type": "string",
              "required": false,
              "description": "Polymorphic ID to entity"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Task belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Task assigned to one user"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Task created by one user"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "Task can be linked to contact (polymorphic)"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Task can be linked to company (polymorphic)"
            },
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "Task can be linked to deal (polymorphic)"
            }
          ]
        },
        {
          "id": "model-note",
          "name": "Note",
          "description": "Note/comment attached to CRM entities",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "authorId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User (author)"
            },
            {
              "name": "content",
              "type": "string",
              "required": true,
              "description": "Note content (rich text/markdown)"
            },
            {
              "name": "isPinned",
              "type": "boolean",
              "required": true,
              "description": "Is pinned note"
            },
            {
              "name": "subjectType",
              "type": "enum",
              "required": true,
              "description": "Polymorphic type: CONTACT, COMPANY, DEAL"
            },
            {
              "name": "subjectId",
              "type": "string",
              "required": true,
              "description": "Polymorphic ID to entity"
            },
            {
              "name": "mentions",
              "type": "json",
              "required": false,
              "description": "Array of mentioned user IDs"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Note belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Note created by one user"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "Note can be linked to contact (polymorphic)"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Note can be linked to company (polymorphic)"
            },
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "Note can be linked to deal (polymorphic)"
            }
          ]
        },
        {
          "id": "model-tag",
          "name": "Tag",
          "description": "Tag for categorizing entities",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Tag name"
            },
            {
              "name": "color",
              "type": "string",
              "required": false,
              "description": "Tag color (hex code)"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Tag description"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Tag belongs to one organization"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-many",
              "description": "Tag can be on many contacts"
            },
            {
              "targetModel": "Company",
              "type": "many-to-many",
              "description": "Tag can be on many companies"
            },
            {
              "targetModel": "Deal",
              "type": "many-to-many",
              "description": "Tag can be on many deals"
            }
          ]
        },
        {
          "id": "model-contact-tag",
          "name": "ContactTag",
          "description": "Junction table for Contact-Tag relationship",
          "fields": [
            {
              "name": "contactId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Contact"
            },
            {
              "name": "tagId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Tag"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "Belongs to one contact"
            },
            {
              "targetModel": "Tag",
              "type": "many-to-one",
              "description": "Belongs to one tag"
            }
          ]
        },
        {
          "id": "model-company-tag",
          "name": "CompanyTag",
          "description": "Junction table for Company-Tag relationship",
          "fields": [
            {
              "name": "companyId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Company"
            },
            {
              "name": "tagId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Tag"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "Belongs to one company"
            },
            {
              "targetModel": "Tag",
              "type": "many-to-one",
              "description": "Belongs to one tag"
            }
          ]
        },
        {
          "id": "model-deal-tag",
          "name": "DealTag",
          "description": "Junction table for Deal-Tag relationship",
          "fields": [
            {
              "name": "dealId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Deal"
            },
            {
              "name": "tagId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Tag"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "Belongs to one deal"
            },
            {
              "targetModel": "Tag",
              "type": "many-to-one",
              "description": "Belongs to one tag"
            }
          ]
        },
        {
          "id": "model-file",
          "name": "File",
          "description": "File/document attached to CRM entities",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "uploadedById",
              "type": "string",
              "required": true,
              "description": "Foreign key to User (uploader)"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Original filename"
            },
            {
              "name": "key",
              "type": "string",
              "required": true,
              "description": "Storage key/path in S3/R2"
            },
            {
              "name": "bucket",
              "type": "string",
              "required": true,
              "description": "Storage bucket name"
            },
            {
              "name": "mimeType",
              "type": "string",
              "required": true,
              "description": "File MIME type"
            },
            {
              "name": "size",
              "type": "number",
              "required": true,
              "description": "File size in bytes"
            },
            {
              "name": "subjectType",
              "type": "enum",
              "required": true,
              "description": "Polymorphic type: CONTACT, COMPANY, DEAL"
            },
            {
              "name": "subjectId",
              "type": "string",
              "required": true,
              "description": "Polymorphic ID to entity"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Upload timestamp"
            },
            {
              "name": "deletedAt",
              "type": "Date",
              "required": false,
              "description": "Soft delete timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "File belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "File uploaded by one user"
            },
            {
              "targetModel": "Contact",
              "type": "many-to-one",
              "description": "File can be linked to contact (polymorphic)"
            },
            {
              "targetModel": "Company",
              "type": "many-to-one",
              "description": "File can be linked to company (polymorphic)"
            },
            {
              "targetModel": "Deal",
              "type": "many-to-one",
              "description": "File can be linked to deal (polymorphic)"
            }
          ]
        },
        {
          "id": "model-custom-field-definition",
          "name": "CustomFieldDefinition",
          "description": "Definition of a custom field for an entity type",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "entityType",
              "type": "enum",
              "required": true,
              "description": "Entity type: CONTACT, COMPANY, DEAL"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Field name/key"
            },
            {
              "name": "label",
              "type": "string",
              "required": true,
              "description": "Display label"
            },
            {
              "name": "fieldType",
              "type": "enum",
              "required": true,
              "description": "Type: TEXT, NUMBER, DATE, BOOLEAN, SELECT, MULTI_SELECT, URL, EMAIL, PHONE"
            },
            {
              "name": "options",
              "type": "json",
              "required": false,
              "description": "Options for SELECT/MULTI_SELECT (JSONB array)"
            },
            {
              "name": "isRequired",
              "type": "boolean",
              "required": true,
              "description": "Is field required"
            },
            {
              "name": "defaultValue",
              "type": "string",
              "required": false,
              "description": "Default value"
            },
            {
              "name": "placeholder",
              "type": "string",
              "required": false,
              "description": "Input placeholder text"
            },
            {
              "name": "helpText",
              "type": "string",
              "required": false,
              "description": "Help text for users"
            },
            {
              "name": "validation",
              "type": "json",
              "required": false,
              "description": "Validation rules (regex, min, max, etc.)"
            },
            {
              "name": "position",
              "type": "number",
              "required": true,
              "description": "Display order"
            },
            {
              "name": "isActive",
              "type": "boolean",
              "required": true,
              "description": "Is field active"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Definition belongs to one organization"
            }
          ]
        },
        {
          "id": "model-lead-assignment-rule",
          "name": "LeadAssignmentRule",
          "description": "Rule for automatic lead/contact assignment",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Rule name"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Rule description"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: ROUND_ROBIN, TERRITORY, WEIGHTED"
            },
            {
              "name": "conditions",
              "type": "json",
              "required": false,
              "description": "Conditions for rule (JSONB)"
            },
            {
              "name": "teamId",
              "type": "string",
              "required": false,
              "description": "Foreign key to Team for assignment"
            },
            {
              "name": "userIds",
              "type": "json",
              "required": false,
              "description": "Array of user IDs for round-robin"
            },
            {
              "name": "weights",
              "type": "json",
              "required": false,
              "description": "Weight per user for weighted assignment"
            },
            {
              "name": "currentIndex",
              "type": "number",
              "required": false,
              "description": "Current index for round-robin"
            },
            {
              "name": "priority",
              "type": "number",
              "required": true,
              "description": "Rule priority (lower = higher)"
            },
            {
              "name": "isActive",
              "type": "boolean",
              "required": true,
              "description": "Is rule active"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Rule belongs to one organization"
            },
            {
              "targetModel": "Team",
              "type": "many-to-one",
              "description": "Rule can assign to one team"
            }
          ]
        },
        {
          "id": "model-import-job",
          "name": "ImportJob",
          "description": "Batch import job for contacts/companies",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User who initiated"
            },
            {
              "name": "entityType",
              "type": "enum",
              "required": true,
              "description": "Type: CONTACT, COMPANY"
            },
            {
              "name": "fileName",
              "type": "string",
              "required": true,
              "description": "Original file name"
            },
            {
              "name": "fileKey",
              "type": "string",
              "required": true,
              "description": "Storage key for uploaded file"
            },
            {
              "name": "fieldMapping",
              "type": "json",
              "required": true,
              "description": "Column to field mapping (JSONB)"
            },
            {
              "name": "status",
              "type": "enum",
              "required": true,
              "description": "Status: PENDING, PROCESSING, COMPLETED, FAILED"
            },
            {
              "name": "totalRows",
              "type": "number",
              "required": false,
              "description": "Total rows in file"
            },
            {
              "name": "processedRows",
              "type": "number",
              "required": false,
              "description": "Rows processed"
            },
            {
              "name": "successCount",
              "type": "number",
              "required": false,
              "description": "Successful imports"
            },
            {
              "name": "errorCount",
              "type": "number",
              "required": false,
              "description": "Failed imports"
            },
            {
              "name": "duplicateCount",
              "type": "number",
              "required": false,
              "description": "Duplicates found"
            },
            {
              "name": "errors",
              "type": "json",
              "required": false,
              "description": "Array of error details (JSONB)"
            },
            {
              "name": "duplicateHandling",
              "type": "enum",
              "required": true,
              "description": "SKIP, UPDATE, CREATE_NEW"
            },
            {
              "name": "startedAt",
              "type": "Date",
              "required": false,
              "description": "Processing start time"
            },
            {
              "name": "completedAt",
              "type": "Date",
              "required": false,
              "description": "Processing completion time"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Job belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Job initiated by one user"
            }
          ]
        },
        {
          "id": "model-export-job",
          "name": "ExportJob",
          "description": "Batch export job for data/reports",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User who initiated"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: CONTACTS, COMPANIES, DEALS, ACTIVITIES, REPORT"
            },
            {
              "name": "format",
              "type": "enum",
              "required": true,
              "description": "Format: CSV, XLSX, PDF"
            },
            {
              "name": "filters",
              "type": "json",
              "required": false,
              "description": "Applied filters (JSONB)"
            },
            {
              "name": "columns",
              "type": "json",
              "required": false,
              "description": "Columns to export (JSONB array)"
            },
            {
              "name": "status",
              "type": "enum",
              "required": true,
              "description": "Status: PENDING, PROCESSING, COMPLETED, FAILED"
            },
            {
              "name": "fileKey",
              "type": "string",
              "required": false,
              "description": "Storage key for generated file"
            },
            {
              "name": "fileName",
              "type": "string",
              "required": false,
              "description": "Generated file name"
            },
            {
              "name": "recordCount",
              "type": "number",
              "required": false,
              "description": "Number of records exported"
            },
            {
              "name": "error",
              "type": "string",
              "required": false,
              "description": "Error message if failed"
            },
            {
              "name": "expiresAt",
              "type": "Date",
              "required": false,
              "description": "When download link expires"
            },
            {
              "name": "startedAt",
              "type": "Date",
              "required": false,
              "description": "Processing start time"
            },
            {
              "name": "completedAt",
              "type": "Date",
              "required": false,
              "description": "Processing completion time"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Job belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Job initiated by one user"
            }
          ]
        },
        {
          "id": "model-saved-filter",
          "name": "SavedFilter",
          "description": "Saved filter/view for entity lists",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User (owner)"
            },
            {
              "name": "entityType",
              "type": "enum",
              "required": true,
              "description": "Type: CONTACT, COMPANY, DEAL, TASK, ACTIVITY"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Filter name"
            },
            {
              "name": "filters",
              "type": "json",
              "required": true,
              "description": "Filter conditions (JSONB)"
            },
            {
              "name": "columns",
              "type": "json",
              "required": false,
              "description": "Column configuration (JSONB)"
            },
            {
              "name": "sortBy",
              "type": "string",
              "required": false,
              "description": "Sort field"
            },
            {
              "name": "sortOrder",
              "type": "enum",
              "required": false,
              "description": "Sort order: ASC, DESC"
            },
            {
              "name": "isDefault",
              "type": "boolean",
              "required": true,
              "description": "Is default view for user"
            },
            {
              "name": "isShared",
              "type": "boolean",
              "required": true,
              "description": "Is shared with team"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Filter belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Filter owned by one user"
            }
          ]
        },
        {
          "id": "model-saved-report",
          "name": "SavedReport",
          "description": "Saved custom report configuration",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User (owner)"
            },
            {
              "name": "name",
              "type": "string",
              "required": true,
              "description": "Report name"
            },
            {
              "name": "description",
              "type": "string",
              "required": false,
              "description": "Report description"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: PIPELINE, ACTIVITY, FORECAST, LEADERBOARD, CUSTOM"
            },
            {
              "name": "config",
              "type": "json",
              "required": true,
              "description": "Report configuration (JSONB)"
            },
            {
              "name": "filters",
              "type": "json",
              "required": false,
              "description": "Applied filters (JSONB)"
            },
            {
              "name": "dateRange",
              "type": "json",
              "required": false,
              "description": "Date range configuration"
            },
            {
              "name": "chartType",
              "type": "enum",
              "required": false,
              "description": "Chart: BAR, LINE, PIE, FUNNEL, TABLE"
            },
            {
              "name": "isShared",
              "type": "boolean",
              "required": true,
              "description": "Is shared with team"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Report belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Report owned by one user"
            }
          ]
        },
        {
          "id": "model-audit-log",
          "name": "AuditLog",
          "description": "Audit trail for tracking all data changes",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": false,
              "description": "Foreign key to User (who made change)"
            },
            {
              "name": "action",
              "type": "enum",
              "required": true,
              "description": "Action: CREATE, UPDATE, DELETE, RESTORE, LOGIN, LOGOUT, EXPORT"
            },
            {
              "name": "entityType",
              "type": "string",
              "required": true,
              "description": "Entity type name"
            },
            {
              "name": "entityId",
              "type": "string",
              "required": true,
              "description": "Entity ID that changed"
            },
            {
              "name": "oldValues",
              "type": "json",
              "required": false,
              "description": "Previous values (JSONB)"
            },
            {
              "name": "newValues",
              "type": "json",
              "required": false,
              "description": "New values (JSONB)"
            },
            {
              "name": "changedFields",
              "type": "json",
              "required": false,
              "description": "List of changed field names"
            },
            {
              "name": "ipAddress",
              "type": "string",
              "required": false,
              "description": "Client IP address"
            },
            {
              "name": "userAgent",
              "type": "string",
              "required": false,
              "description": "Client user agent"
            },
            {
              "name": "metadata",
              "type": "json",
              "required": false,
              "description": "Additional context (JSONB)"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Timestamp of change"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Log belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Log associated with one user"
            }
          ]
        },
        {
          "id": "model-notification",
          "name": "Notification",
          "description": "In-app notification for users",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "userId",
              "type": "string",
              "required": true,
              "description": "Foreign key to User (recipient)"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: TASK_DUE, TASK_ASSIGNED, DEAL_STAGE_CHANGED, MENTION, IMPORT_COMPLETE, EXPORT_READY"
            },
            {
              "name": "title",
              "type": "string",
              "required": true,
              "description": "Notification title"
            },
            {
              "name": "message",
              "type": "string",
              "required": true,
              "description": "Notification message"
            },
            {
              "name": "linkType",
              "type": "enum",
              "required": false,
              "description": "Link entity type: CONTACT, COMPANY, DEAL, TASK"
            },
            {
              "name": "linkId",
              "type": "string",
              "required": false,
              "description": "Link entity ID"
            },
            {
              "name": "isRead",
              "type": "boolean",
              "required": true,
              "description": "Has been read"
            },
            {
              "name": "readAt",
              "type": "Date",
              "required": false,
              "description": "Read timestamp"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Notification belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Notification for one user"
            }
          ]
        },
        {
          "id": "model-data-deletion-request",
          "name": "DataDeletionRequest",
          "description": "GDPR data deletion request tracking",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": true,
              "description": "Foreign key to Organization"
            },
            {
              "name": "requestedById",
              "type": "string",
              "required": true,
              "description": "Foreign key to User who requested"
            },
            {
              "name": "processedById",
              "type": "string",
              "required": false,
              "description": "Foreign key to User who processed"
            },
            {
              "name": "entityType",
              "type": "enum",
              "required": true,
              "description": "Type: CONTACT, USER"
            },
            {
              "name": "entityId",
              "type": "string",
              "required": true,
              "description": "ID of entity to delete"
            },
            {
              "name": "reason",
              "type": "string",
              "required": false,
              "description": "Reason for deletion"
            },
            {
              "name": "status",
              "type": "enum",
              "required": true,
              "description": "Status: PENDING, APPROVED, COMPLETED, REJECTED"
            },
            {
              "name": "scheduledFor",
              "type": "Date",
              "required": false,
              "description": "Scheduled deletion date"
            },
            {
              "name": "completedAt",
              "type": "Date",
              "required": false,
              "description": "Completion timestamp"
            },
            {
              "name": "notes",
              "type": "string",
              "required": false,
              "description": "Admin notes"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Request timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Request belongs to one organization"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Request made by one user"
            },
            {
              "targetModel": "User",
              "type": "many-to-one",
              "description": "Request processed by one user"
            }
          ]
        },
        {
          "id": "model-scheduled-job",
          "name": "ScheduledJob",
          "description": "Background job scheduling and status tracking",
          "fields": [
            {
              "name": "id",
              "type": "string",
              "required": true,
              "description": "Unique identifier (UUID)"
            },
            {
              "name": "organizationId",
              "type": "string",
              "required": false,
              "description": "Foreign key to Organization (null for system jobs)"
            },
            {
              "name": "type",
              "type": "enum",
              "required": true,
              "description": "Type: REMINDER, RECURRING_TASK, DATA_CLEANUP, BACKUP, REPORT_GENERATION"
            },
            {
              "name": "payload",
              "type": "json",
              "required": true,
              "description": "Job payload/parameters (JSONB)"
            },
            {
              "name": "status",
              "type": "enum",
              "required": true,
              "description": "Status: PENDING, RUNNING, COMPLETED, FAILED, CANCELLED"
            },
            {
              "name": "scheduledFor",
              "type": "Date",
              "required": true,
              "description": "Scheduled execution time"
            },
            {
              "name": "startedAt",
              "type": "Date",
              "required": false,
              "description": "Actual start time"
            },
            {
              "name": "completedAt",
              "type": "Date",
              "required": false,
              "description": "Completion time"
            },
            {
              "name": "error",
              "type": "string",
              "required": false,
              "description": "Error message if failed"
            },
            {
              "name": "retryCount",
              "type": "number",
              "required": true,
              "description": "Number of retry attempts"
            },
            {
              "name": "maxRetries",
              "type": "number",
              "required": true,
              "description": "Maximum retry attempts"
            },
            {
              "name": "createdAt",
              "type": "Date",
              "required": true,
              "description": "Creation timestamp"
            },
            {
              "name": "updatedAt",
              "type": "Date",
              "required": true,
              "description": "Last update timestamp"
            }
          ],
          "relationships": [
            {
              "targetModel": "Organization",
              "type": "many-to-one",
              "description": "Job can belong to one organization"
            }
          ]
        }
      ],
      "apiEndpoints": [
        {
          "id": "api-auth-register",
          "path": "/api/auth/register",
          "method": "POST",
          "description": "Register a new user and organization",
          "requestSchema": "{ email: string, password: string, name: string, organizationName: string }",
          "responseSchema": "{ user: User, organization: Organization, token: string }",
          "authentication": false,
          "relatedStories": [
            "AUTH-001"
          ]
        },
        {
          "id": "api-auth-login",
          "path": "/api/auth/login",
          "method": "POST",
          "description": "Authenticate user with email and password",
          "requestSchema": "{ email: string, password: string }",
          "responseSchema": "{ user: User, token: string, expiresAt: string }",
          "authentication": false,
          "relatedStories": [
            "AUTH-002"
          ]
        },
        {
          "id": "api-auth-logout",
          "path": "/api/auth/logout",
          "method": "POST",
          "description": "Invalidate current session",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "AUTH-003"
          ]
        },
        {
          "id": "api-auth-refresh",
          "path": "/api/auth/refresh",
          "method": "POST",
          "description": "Refresh authentication token",
          "requestSchema": "{ refreshToken: string }",
          "responseSchema": "{ token: string, expiresAt: string }",
          "authentication": false,
          "relatedStories": [
            "AUTH-004"
          ]
        },
        {
          "id": "api-auth-forgot-password",
          "path": "/api/auth/forgot-password",
          "method": "POST",
          "description": "Request password reset email",
          "requestSchema": "{ email: string }",
          "responseSchema": "{ success: boolean, message: string }",
          "authentication": false,
          "relatedStories": [
            "AUTH-005"
          ]
        },
        {
          "id": "api-auth-reset-password",
          "path": "/api/auth/reset-password",
          "method": "POST",
          "description": "Reset password with token",
          "requestSchema": "{ token: string, password: string }",
          "responseSchema": "{ success: boolean }",
          "authentication": false,
          "relatedStories": [
            "AUTH-006"
          ]
        },
        {
          "id": "api-auth-verify-email",
          "path": "/api/auth/verify-email",
          "method": "POST",
          "description": "Verify email address with token",
          "requestSchema": "{ token: string }",
          "responseSchema": "{ success: boolean, user: User }",
          "authentication": false,
          "relatedStories": [
            "AUTH-007"
          ]
        },
        {
          "id": "api-auth-google",
          "path": "/api/auth/google",
          "method": "POST",
          "description": "Authenticate with Google OAuth",
          "requestSchema": "{ idToken: string }",
          "responseSchema": "{ user: User, token: string, isNewUser: boolean }",
          "authentication": false,
          "relatedStories": [
            "AUTH-008"
          ]
        },
        {
          "id": "api-auth-me",
          "path": "/api/auth/me",
          "method": "GET",
          "description": "Get current authenticated user",
          "requestSchema": "{}",
          "responseSchema": "{ user: User, organization: Organization, permissions: string[] }",
          "authentication": true,
          "relatedStories": [
            "AUTH-009"
          ]
        },
        {
          "id": "api-auth-change-password",
          "path": "/api/auth/change-password",
          "method": "POST",
          "description": "Change password for authenticated user",
          "requestSchema": "{ currentPassword: string, newPassword: string }",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "AUTH-010"
          ]
        },
        {
          "id": "api-users-list",
          "path": "/api/users",
          "method": "GET",
          "description": "List all users in organization with pagination and filtering",
          "requestSchema": "{ page?: number, limit?: number, search?: string, role?: string, teamId?: string, status?: 'active' | 'inactive' }",
          "responseSchema": "{ users: User[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "USER-001"
          ]
        },
        {
          "id": "api-users-create",
          "path": "/api/users",
          "method": "POST",
          "description": "Create a new user in organization",
          "requestSchema": "{ email: string, name: string, role: 'admin' | 'manager' | 'sales_rep' | 'readonly', teamIds?: string[] }",
          "responseSchema": "{ user: User }",
          "authentication": true,
          "relatedStories": [
            "USER-002"
          ]
        },
        {
          "id": "api-users-get",
          "path": "/api/users/[id]",
          "method": "GET",
          "description": "Get user by ID",
          "requestSchema": "{}",
          "responseSchema": "{ user: User, teams: Team[], activityStats: { dealsWon: number, revenue: number, activitiesLogged: number } }",
          "authentication": true,
          "relatedStories": [
            "USER-003"
          ]
        },
        {
          "id": "api-users-update",
          "path": "/api/users/[id]",
          "method": "PATCH",
          "description": "Update user details",
          "requestSchema": "{ name?: string, email?: string, role?: string, profilePictureUrl?: string, phone?: string }",
          "responseSchema": "{ user: User }",
          "authentication": true,
          "relatedStories": [
            "USER-004"
          ]
        },
        {
          "id": "api-users-delete",
          "path": "/api/users/[id]",
          "method": "DELETE",
          "description": "Deactivate user (soft delete)",
          "requestSchema": "{ reassignTo?: string }",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "USER-005"
          ]
        },
        {
          "id": "api-users-activity",
          "path": "/api/users/[id]/activity",
          "method": "GET",
          "description": "Get user activity log",
          "requestSchema": "{ page?: number, limit?: number, startDate?: string, endDate?: string }",
          "responseSchema": "{ activities: Activity[], total: number }",
          "authentication": true,
          "relatedStories": [
            "USER-006"
          ]
        },
        {
          "id": "api-users-leaderboard",
          "path": "/api/users/leaderboard",
          "method": "GET",
          "description": "Get sales leaderboard",
          "requestSchema": "{ period?: 'week' | 'month' | 'quarter' | 'year', metric?: 'deals' | 'revenue' | 'activities', teamId?: string }",
          "responseSchema": "{ rankings: { user: User, rank: number, value: number, change: number }[] }",
          "authentication": true,
          "relatedStories": [
            "USER-007"
          ]
        },
        {
          "id": "api-teams-list",
          "path": "/api/teams",
          "method": "GET",
          "description": "List all teams in organization",
          "requestSchema": "{ page?: number, limit?: number, includeMembers?: boolean }",
          "responseSchema": "{ teams: Team[], total: number }",
          "authentication": true,
          "relatedStories": [
            "TEAM-001"
          ]
        },
        {
          "id": "api-teams-create",
          "path": "/api/teams",
          "method": "POST",
          "description": "Create a new team",
          "requestSchema": "{ name: string, description?: string, parentTeamId?: string, territory?: string }",
          "responseSchema": "{ team: Team }",
          "authentication": true,
          "relatedStories": [
            "TEAM-002"
          ]
        },
        {
          "id": "api-teams-get",
          "path": "/api/teams/[id]",
          "method": "GET",
          "description": "Get team by ID with members",
          "requestSchema": "{}",
          "responseSchema": "{ team: Team, members: User[], childTeams: Team[], stats: { totalDeals: number, totalRevenue: number } }",
          "authentication": true,
          "relatedStories": [
            "TEAM-003"
          ]
        },
        {
          "id": "api-teams-update",
          "path": "/api/teams/[id]",
          "method": "PATCH",
          "description": "Update team details",
          "requestSchema": "{ name?: string, description?: string, parentTeamId?: string, territory?: string }",
          "responseSchema": "{ team: Team }",
          "authentication": true,
          "relatedStories": [
            "TEAM-004"
          ]
        },
        {
          "id": "api-teams-delete",
          "path": "/api/teams/[id]",
          "method": "DELETE",
          "description": "Delete team",
          "requestSchema": "{ reassignMembersTo?: string }",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "TEAM-005"
          ]
        },
        {
          "id": "api-teams-members-add",
          "path": "/api/teams/[id]/members",
          "method": "POST",
          "description": "Add members to team",
          "requestSchema": "{ userIds: string[], role?: 'member' | 'lead' }",
          "responseSchema": "{ team: Team, addedMembers: User[] }",
          "authentication": true,
          "relatedStories": [
            "TEAM-006"
          ]
        },
        {
          "id": "api-teams-members-remove",
          "path": "/api/teams/[id]/members/[userId]",
          "method": "DELETE",
          "description": "Remove member from team",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "TEAM-007"
          ]
        },
        {
          "id": "api-contacts-list",
          "path": "/api/contacts",
          "method": "GET",
          "description": "List contacts with pagination, search, and filtering",
          "requestSchema": "{ page?: number, limit?: number, search?: string, tags?: string[], companyId?: string, ownerId?: string, createdAfter?: string, createdBefore?: string, sortBy?: string, sortOrder?: 'asc' | 'desc' }",
          "responseSchema": "{ contacts: Contact[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-001"
          ]
        },
        {
          "id": "api-contacts-create",
          "path": "/api/contacts",
          "method": "POST",
          "description": "Create a new contact",
          "requestSchema": "{ firstName: string, lastName: string, email?: string, phone?: string, jobTitle?: string, companyIds?: string[], address?: { street?: string, city?: string, state?: string, country?: string, postalCode?: string }, socialLinks?: { linkedin?: string, twitter?: string }, tags?: string[], customFields?: Record<string, any>, ownerId?: string }",
          "responseSchema": "{ contact: Contact }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-002"
          ]
        },
        {
          "id": "api-contacts-get",
          "path": "/api/contacts/[id]",
          "method": "GET",
          "description": "Get contact by ID with full details",
          "requestSchema": "{}",
          "responseSchema": "{ contact: Contact, companies: Company[], deals: Deal[], recentActivities: Activity[], tags: Tag[] }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-003"
          ]
        },
        {
          "id": "api-contacts-update",
          "path": "/api/contacts/[id]",
          "method": "PATCH",
          "description": "Update contact details",
          "requestSchema": "{ firstName?: string, lastName?: string, email?: string, phone?: string, jobTitle?: string, address?: object, socialLinks?: object, customFields?: Record<string, any>, ownerId?: string }",
          "responseSchema": "{ contact: Contact }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-004"
          ]
        },
        {
          "id": "api-contacts-delete",
          "path": "/api/contacts/[id]",
          "method": "DELETE",
          "description": "Soft delete contact",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-005"
          ]
        },
        {
          "id": "api-contacts-timeline",
          "path": "/api/contacts/[id]/timeline",
          "method": "GET",
          "description": "Get contact activity timeline",
          "requestSchema": "{ page?: number, limit?: number, types?: string[] }",
          "responseSchema": "{ timeline: { type: string, data: Activity | Task | Note | Deal, timestamp: string }[], total: number }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-006"
          ]
        },
        {
          "id": "api-contacts-tags-update",
          "path": "/api/contacts/[id]/tags",
          "method": "PUT",
          "description": "Update contact tags",
          "requestSchema": "{ tags: string[] }",
          "responseSchema": "{ contact: Contact, tags: Tag[] }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-007"
          ]
        },
        {
          "id": "api-contacts-companies-link",
          "path": "/api/contacts/[id]/companies",
          "method": "POST",
          "description": "Link contact to companies",
          "requestSchema": "{ companyIds: string[], isPrimary?: string }",
          "responseSchema": "{ contact: Contact, companies: Company[] }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-008"
          ]
        },
        {
          "id": "api-contacts-companies-unlink",
          "path": "/api/contacts/[id]/companies/[companyId]",
          "method": "DELETE",
          "description": "Unlink contact from company",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-009"
          ]
        },
        {
          "id": "api-contacts-duplicates",
          "path": "/api/contacts/duplicates",
          "method": "GET",
          "description": "Find potential duplicate contacts",
          "requestSchema": "{ page?: number, limit?: number, threshold?: number }",
          "responseSchema": "{ duplicateGroups: { contacts: Contact[], matchScore: number, matchReason: string }[], total: number }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-010"
          ]
        },
        {
          "id": "api-contacts-merge",
          "path": "/api/contacts/merge",
          "method": "POST",
          "description": "Merge duplicate contacts",
          "requestSchema": "{ primaryContactId: string, mergeContactIds: string[], fieldResolutions?: Record<string, string> }",
          "responseSchema": "{ contact: Contact, mergedCount: number }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-011"
          ]
        },
        {
          "id": "api-contacts-bulk-update",
          "path": "/api/contacts/bulk",
          "method": "PATCH",
          "description": "Bulk update multiple contacts",
          "requestSchema": "{ contactIds: string[], updates: { ownerId?: string, tags?: string[], customFields?: Record<string, any> } }",
          "responseSchema": "{ updatedCount: number, contacts: Contact[] }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-012"
          ]
        },
        {
          "id": "api-contacts-bulk-delete",
          "path": "/api/contacts/bulk",
          "method": "DELETE",
          "description": "Bulk delete multiple contacts",
          "requestSchema": "{ contactIds: string[] }",
          "responseSchema": "{ deletedCount: number }",
          "authentication": true,
          "relatedStories": [
            "CONTACT-013"
          ]
        },
        {
          "id": "api-companies-list",
          "path": "/api/companies",
          "method": "GET",
          "description": "List companies with pagination and filtering",
          "requestSchema": "{ page?: number, limit?: number, search?: string, industry?: string, tags?: string[], parentCompanyId?: string, minEmployees?: number, maxEmployees?: number, minRevenue?: number, maxRevenue?: number, sortBy?: string, sortOrder?: 'asc' | 'desc' }",
          "responseSchema": "{ companies: Company[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-001"
          ]
        },
        {
          "id": "api-companies-create",
          "path": "/api/companies",
          "method": "POST",
          "description": "Create a new company",
          "requestSchema": "{ name: string, domain?: string, industry?: string, employeeCount?: number, annualRevenue?: number, address?: { street?: string, city?: string, state?: string, country?: string, postalCode?: string }, phone?: string, website?: string, parentCompanyId?: string, tags?: string[], customFields?: Record<string, any>, ownerId?: string }",
          "responseSchema": "{ company: Company }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-002"
          ]
        },
        {
          "id": "api-companies-get",
          "path": "/api/companies/[id]",
          "method": "GET",
          "description": "Get company by ID with full details",
          "requestSchema": "{}",
          "responseSchema": "{ company: Company, contacts: Contact[], deals: Deal[], childCompanies: Company[], parentCompany: Company | null, recentActivities: Activity[], files: File[] }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-003"
          ]
        },
        {
          "id": "api-companies-update",
          "path": "/api/companies/[id]",
          "method": "PATCH",
          "description": "Update company details",
          "requestSchema": "{ name?: string, domain?: string, industry?: string, employeeCount?: number, annualRevenue?: number, address?: object, phone?: string, website?: string, parentCompanyId?: string, customFields?: Record<string, any>, ownerId?: string }",
          "responseSchema": "{ company: Company }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-004"
          ]
        },
        {
          "id": "api-companies-delete",
          "path": "/api/companies/[id]",
          "method": "DELETE",
          "description": "Soft delete company",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-005"
          ]
        },
        {
          "id": "api-companies-timeline",
          "path": "/api/companies/[id]/timeline",
          "method": "GET",
          "description": "Get company activity timeline",
          "requestSchema": "{ page?: number, limit?: number, types?: string[] }",
          "responseSchema": "{ timeline: { type: string, data: Activity | Task | Note | Deal, timestamp: string }[], total: number }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-006"
          ]
        },
        {
          "id": "api-companies-contacts",
          "path": "/api/companies/[id]/contacts",
          "method": "GET",
          "description": "Get all contacts for a company",
          "requestSchema": "{ page?: number, limit?: number }",
          "responseSchema": "{ contacts: Contact[], total: number }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-007"
          ]
        },
        {
          "id": "api-companies-hierarchy",
          "path": "/api/companies/[id]/hierarchy",
          "method": "GET",
          "description": "Get company hierarchy (parent and children)",
          "requestSchema": "{}",
          "responseSchema": "{ company: Company, parent: Company | null, children: Company[], ancestors: Company[] }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-008"
          ]
        },
        {
          "id": "api-companies-tags-update",
          "path": "/api/companies/[id]/tags",
          "method": "PUT",
          "description": "Update company tags",
          "requestSchema": "{ tags: string[] }",
          "responseSchema": "{ company: Company, tags: Tag[] }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-009"
          ]
        },
        {
          "id": "api-companies-notes",
          "path": "/api/companies/[id]/notes",
          "method": "GET",
          "description": "Get company notes",
          "requestSchema": "{ page?: number, limit?: number }",
          "responseSchema": "{ notes: Note[], total: number }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-010"
          ]
        },
        {
          "id": "api-companies-notes-create",
          "path": "/api/companies/[id]/notes",
          "method": "POST",
          "description": "Add note to company",
          "requestSchema": "{ content: string, isPinned?: boolean }",
          "responseSchema": "{ note: Note }",
          "authentication": true,
          "relatedStories": [
            "COMPANY-011"
          ]
        },
        {
          "id": "api-pipelines-list",
          "path": "/api/pipelines",
          "method": "GET",
          "description": "List all pipelines for organization",
          "requestSchema": "{ teamId?: string, includeStages?: boolean }",
          "responseSchema": "{ pipelines: Pipeline[] }",
          "authentication": true,
          "relatedStories": [
            "PIPELINE-001"
          ]
        },
        {
          "id": "api-pipelines-create",
          "path": "/api/pipelines",
          "method": "POST",
          "description": "Create a new pipeline",
          "requestSchema": "{ name: string, teamId?: string, stages: { name: string, probability: number, order: number }[] }",
          "responseSchema": "{ pipeline: Pipeline, stages: PipelineStage[] }",
          "authentication": true,
          "relatedStories": [
            "PIPELINE-002"
          ]
        },
        {
          "id": "api-pipelines-get",
          "path": "/api/pipelines/[id]",
          "method": "GET",
          "description": "Get pipeline with stages and deal counts",
          "requestSchema": "{}",
          "responseSchema": "{ pipeline: Pipeline, stages: PipelineStage[], dealCounts: Record<string, number>, totalValue: Record<string, number> }",
          "authentication": true,
          "relatedStories": [
            "PIPELINE-003"
          ]
        },
        {
          "id": "api-pipelines-update",
          "path": "/api/pipelines/[id]",
          "method": "PATCH",
          "description": "Update pipeline details",
          "requestSchema": "{ name?: string, teamId?: string }",
          "responseSchema": "{ pipeline: Pipeline }",
          "authentication": true,
          "relatedStories": [
            "PIPELINE-004"
          ]
        },
        {
          "id": "api-pipelines-delete",
          "path": "/api/pipelines/[id]",
          "method": "DELETE",
          "description": "Delete pipeline",
          "requestSchema": "{ moveDealsToPipelineId?: string }",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "PIPELINE-005"
          ]
        },
        {
          "id": "api-pipelines-stages-update",
          "path": "/api/pipelines/[id]/stages",
          "method": "PUT",
          "description": "Update pipeline stages",
          "requestSchema": "{ stages: { id?: string, name: string, probability: number, order: number }[] }",
          "responseSchema": "{ pipeline: Pipeline, stages: PipelineStage[] }",
          "authentication": true,
          "relatedStories": [
            "PIPELINE-006"
          ]
        },
        {
          "id": "api-deals-list",
          "path": "/api/deals",
          "method": "GET",
          "description": "List deals with pagination and filtering",
          "requestSchema": "{ page?: number, limit?: number, search?: string, pipelineId?: string, stageId?: string, ownerId?: string, companyId?: string, contactId?: string, status?: 'open' | 'won' | 'lost', minValue?: number, maxValue?: number, expectedCloseAfter?: string, expectedCloseBefore?: string, sortBy?: string, sortOrder?: 'asc' | 'desc' }",
          "responseSchema": "{ deals: Deal[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "DEAL-001"
          ]
        },
        {
          "id": "api-deals-create",
          "path": "/api/deals",
          "method": "POST",
          "description": "Create a new deal",
          "requestSchema": "{ name: string, value: number, pipelineId: string, stageId: string, expectedCloseDate?: string, probability?: number, companyId?: string, contactIds?: string[], ownerId?: string, description?: string, customFields?: Record<string, any> }",
          "responseSchema": "{ deal: Deal }",
          "authentication": true,
          "relatedStories": [
            "DEAL-002"
          ]
        },
        {
          "id": "api-deals-get",
          "path": "/api/deals/[id]",
          "method": "GET",
          "description": "Get deal by ID with full details",
          "requestSchema": "{}",
          "responseSchema": "{ deal: Deal, company: Company | null, contacts: Contact[], activities: Activity[], stageHistory: DealStageHistory[], files: File[] }",
          "authentication": true,
          "relatedStories": [
            "DEAL-003"
          ]
        },
        {
          "id": "api-deals-update",
          "path": "/api/deals/[id]",
          "method": "PATCH",
          "description": "Update deal details",
          "requestSchema": "{ name?: string, value?: number, stageId?: string, expectedCloseDate?: string, probability?: number, companyId?: string, ownerId?: string, description?: string, customFields?: Record<string, any> }",
          "responseSchema": "{ deal: Deal }",
          "authentication": true,
          "relatedStories": [
            "DEAL-004"
          ]
        },
        {
          "id": "api-deals-delete",
          "path": "/api/deals/[id]",
          "method": "DELETE",
          "description": "Soft delete deal",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "DEAL-005"
          ]
        },
        {
          "id": "api-deals-move-stage",
          "path": "/api/deals/[id]/stage",
          "method": "PATCH",
          "description": "Move deal to different stage",
          "requestSchema": "{ stageId: string, note?: string }",
          "responseSchema": "{ deal: Deal, stageHistory: DealStageHistory }",
          "authentication": true,
          "relatedStories": [
            "DEAL-006"
          ]
        },
        {
          "id": "api-deals-close-won",
          "path": "/api/deals/[id]/close-won",
          "method": "POST",
          "description": "Mark deal as won",
          "requestSchema": "{ closedDate?: string, actualValue?: number, notes?: string }",
          "responseSchema": "{ deal: Deal }",
          "authentication": true,
          "relatedStories": [
            "DEAL-007"
          ]
        },
        {
          "id": "api-deals-close-lost",
          "path": "/api/deals/[id]/close-lost",
          "method": "POST",
          "description": "Mark deal as lost",
          "requestSchema": "{ closedDate?: string, lostReason: string, lostToCompetitor?: string, notes?: string }",
          "responseSchema": "{ deal: Deal }",
          "authentication": true,
          "relatedStories": [
            "DEAL-008"
          ]
        },
        {
          "id": "api-deals-reopen",
          "path": "/api/deals/[id]/reopen",
          "method": "POST",
          "description": "Reopen a closed deal",
          "requestSchema": "{ stageId: string, note?: string }",
          "responseSchema": "{ deal: Deal }",
          "authentication": true,
          "relatedStories": [
            "DEAL-009"
          ]
        },
        {
          "id": "api-deals-contacts-link",
          "path": "/api/deals/[id]/contacts",
          "method": "POST",
          "description": "Link contacts to deal",
          "requestSchema": "{ contactIds: string[], role?: string }",
          "responseSchema": "{ deal: Deal, contacts: Contact[] }",
          "authentication": true,
          "relatedStories": [
            "DEAL-010"
          ]
        },
        {
          "id": "api-deals-contacts-unlink",
          "path": "/api/deals/[id]/contacts/[contactId]",
          "method": "DELETE",
          "description": "Unlink contact from deal",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "DEAL-011"
          ]
        },
        {
          "id": "api-deals-stage-history",
          "path": "/api/deals/[id]/stage-history",
          "method": "GET",
          "description": "Get deal stage change history",
          "requestSchema": "{}",
          "responseSchema": "{ history: DealStageHistory[] }",
          "authentication": true,
          "relatedStories": [
            "DEAL-012"
          ]
        },
        {
          "id": "api-deals-kanban",
          "path": "/api/deals/kanban",
          "method": "GET",
          "description": "Get deals organized for kanban view",
          "requestSchema": "{ pipelineId: string, ownerId?: string, teamId?: string }",
          "responseSchema": "{ stages: { stage: PipelineStage, deals: Deal[], totalValue: number }[] }",
          "authentication": true,
          "relatedStories": [
            "DEAL-013"
          ]
        },
        {
          "id": "api-deals-bulk-update",
          "path": "/api/deals/bulk",
          "method": "PATCH",
          "description": "Bulk update multiple deals",
          "requestSchema": "{ dealIds: string[], updates: { ownerId?: string, stageId?: string } }",
          "responseSchema": "{ updatedCount: number, deals: Deal[] }",
          "authentication": true,
          "relatedStories": [
            "DEAL-014"
          ]
        },
        {
          "id": "api-activities-list",
          "path": "/api/activities",
          "method": "GET",
          "description": "List activities with filtering",
          "requestSchema": "{ page?: number, limit?: number, type?: 'call' | 'email' | 'meeting' | 'follow_up' | 'demo', subjectType?: 'contact' | 'company' | 'deal', subjectId?: string, userId?: string, startDate?: string, endDate?: string, sortBy?: string, sortOrder?: 'asc' | 'desc' }",
          "responseSchema": "{ activities: Activity[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "ACTIVITY-001"
          ]
        },
        {
          "id": "api-activities-create",
          "path": "/api/activities",
          "method": "POST",
          "description": "Log a new activity",
          "requestSchema": "{ type: 'call' | 'email' | 'meeting' | 'follow_up' | 'demo', subjectType: 'contact' | 'company' | 'deal', subjectId: string, title: string, description?: string, outcome?: string, duration?: number, occurredAt?: string, participants?: string[] }",
          "responseSchema": "{ activity: Activity }",
          "authentication": true,
          "relatedStories": [
            "ACTIVITY-002"
          ]
        },
        {
          "id": "api-activities-get",
          "path": "/api/activities/[id]",
          "method": "GET",
          "description": "Get activity by ID",
          "requestSchema": "{}",
          "responseSchema": "{ activity: Activity, subject: Contact | Company | Deal }",
          "authentication": true,
          "relatedStories": [
            "ACTIVITY-003"
          ]
        },
        {
          "id": "api-activities-update",
          "path": "/api/activities/[id]",
          "method": "PATCH",
          "description": "Update activity",
          "requestSchema": "{ title?: string, description?: string, outcome?: string, duration?: number, occurredAt?: string }",
          "responseSchema": "{ activity: Activity }",
          "authentication": true,
          "relatedStories": [
            "ACTIVITY-004"
          ]
        },
        {
          "id": "api-activities-delete",
          "path": "/api/activities/[id]",
          "method": "DELETE",
          "description": "Delete activity",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "ACTIVITY-005"
          ]
        },
        {
          "id": "api-activities-calendar",
          "path": "/api/activities/calendar",
          "method": "GET",
          "description": "Get activities in calendar format",
          "requestSchema": "{ startDate: string, endDate: string, userId?: string, types?: string[] }",
          "responseSchema": "{ events: { id: string, title: string, start: string, end: string, type: string, subject: object }[] }",
          "authentication": true,
          "relatedStories": [
            "ACTIVITY-006"
          ]
        },
        {
          "id": "api-tasks-list",
          "path": "/api/tasks",
          "method": "GET",
          "description": "List tasks with filtering",
          "requestSchema": "{ page?: number, limit?: number, status?: 'pending' | 'in_progress' | 'completed' | 'cancelled', type?: 'call' | 'email' | 'meeting' | 'follow_up' | 'demo', subjectType?: 'contact' | 'company' | 'deal', subjectId?: string, assigneeId?: string, dueBefore?: string, dueAfter?: string, priority?: 'low' | 'medium' | 'high', sortBy?: string, sortOrder?: 'asc' | 'desc' }",
          "responseSchema": "{ tasks: Task[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "TASK-001"
          ]
        },
        {
          "id": "api-tasks-create",
          "path": "/api/tasks",
          "method": "POST",
          "description": "Create a new task",
          "requestSchema": "{ title: string, type: 'call' | 'email' | 'meeting' | 'follow_up' | 'demo', subjectType?: 'contact' | 'company' | 'deal', subjectId?: string, description?: string, dueDate: string, priority?: 'low' | 'medium' | 'high', assigneeId?: string, reminderAt?: string, recurrence?: { frequency: 'daily' | 'weekly' | 'monthly', interval: number, endDate?: string } }",
          "responseSchema": "{ task: Task }",
          "authentication": true,
          "relatedStories": [
            "TASK-002"
          ]
        },
        {
          "id": "api-tasks-get",
          "path": "/api/tasks/[id]",
          "method": "GET",
          "description": "Get task by ID",
          "requestSchema": "{}",
          "responseSchema": "{ task: Task, subject: Contact | Company | Deal | null, assignee: User }",
          "authentication": true,
          "relatedStories": [
            "TASK-003"
          ]
        },
        {
          "id": "api-tasks-update",
          "path": "/api/tasks/[id]",
          "method": "PATCH",
          "description": "Update task",
          "requestSchema": "{ title?: string, type?: string, description?: string, dueDate?: string, priority?: string, assigneeId?: string, reminderAt?: string }",
          "responseSchema": "{ task: Task }",
          "authentication": true,
          "relatedStories": [
            "TASK-004"
          ]
        },
        {
          "id": "api-tasks-delete",
          "path": "/api/tasks/[id]",
          "method": "DELETE",
          "description": "Delete task",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "TASK-005"
          ]
        },
        {
          "id": "api-tasks-complete",
          "path": "/api/tasks/[id]/complete",
          "method": "POST",
          "description": "Mark task as completed",
          "requestSchema": "{ outcome?: string, notes?: string, logActivity?: boolean }",
          "responseSchema": "{ task: Task, activity?: Activity }",
          "authentication": true,
          "relatedStories": [
            "TASK-006"
          ]
        },
        {
          "id": "api-tasks-reschedule",
          "path": "/api/tasks/[id]/reschedule",
          "method": "POST",
          "description": "Reschedule task",
          "requestSchema": "{ dueDate: string, reason?: string }",
          "responseSchema": "{ task: Task }",
          "authentication": true,
          "relatedStories": [
            "TASK-007"
          ]
        },
        {
          "id": "api-tasks-my-tasks",
          "path": "/api/tasks/my-tasks",
          "method": "GET",
          "description": "Get current user's tasks",
          "requestSchema": "{ status?: string, dueSoon?: boolean }",
          "responseSchema": "{ overdue: Task[], today: Task[], upcoming: Task[], total: number }",
          "authentication": true,
          "relatedStories": [
            "TASK-008"
          ]
        },
        {
          "id": "api-tasks-bulk-complete",
          "path": "/api/tasks/bulk/complete",
          "method": "POST",
          "description": "Bulk complete tasks",
          "requestSchema": "{ taskIds: string[] }",
          "responseSchema": "{ completedCount: number, tasks: Task[] }",
          "authentication": true,
          "relatedStories": [
            "TASK-009"
          ]
        },
        {
          "id": "api-notes-list",
          "path": "/api/notes",
          "method": "GET",
          "description": "List notes with filtering",
          "requestSchema": "{ page?: number, limit?: number, subjectType?: 'contact' | 'company' | 'deal', subjectId?: string, authorId?: string, isPinned?: boolean, search?: string }",
          "responseSchema": "{ notes: Note[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "NOTE-001"
          ]
        },
        {
          "id": "api-notes-create",
          "path": "/api/notes",
          "method": "POST",
          "description": "Create a new note",
          "requestSchema": "{ subjectType: 'contact' | 'company' | 'deal', subjectId: string, content: string, isPinned?: boolean }",
          "responseSchema": "{ note: Note }",
          "authentication": true,
          "relatedStories": [
            "NOTE-002"
          ]
        },
        {
          "id": "api-notes-get",
          "path": "/api/notes/[id]",
          "method": "GET",
          "description": "Get note by ID",
          "requestSchema": "{}",
          "responseSchema": "{ note: Note, subject: Contact | Company | Deal, author: User }",
          "authentication": true,
          "relatedStories": [
            "NOTE-003"
          ]
        },
        {
          "id": "api-notes-update",
          "path": "/api/notes/[id]",
          "method": "PATCH",
          "description": "Update note",
          "requestSchema": "{ content?: string, isPinned?: boolean }",
          "responseSchema": "{ note: Note }",
          "authentication": true,
          "relatedStories": [
            "NOTE-004"
          ]
        },
        {
          "id": "api-notes-delete",
          "path": "/api/notes/[id]",
          "method": "DELETE",
          "description": "Delete note",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "NOTE-005"
          ]
        },
        {
          "id": "api-tags-list",
          "path": "/api/tags",
          "method": "GET",
          "description": "List all tags in organization",
          "requestSchema": "{ entityType?: 'contact' | 'company' | 'deal', search?: string }",
          "responseSchema": "{ tags: Tag[], total: number }",
          "authentication": true,
          "relatedStories": [
            "TAG-001"
          ]
        },
        {
          "id": "api-tags-create",
          "path": "/api/tags",
          "method": "POST",
          "description": "Create a new tag",
          "requestSchema": "{ name: string, color?: string, entityTypes?: ('contact' | 'company' | 'deal')[] }",
          "responseSchema": "{ tag: Tag }",
          "authentication": true,
          "relatedStories": [
            "TAG-002"
          ]
        },
        {
          "id": "api-tags-update",
          "path": "/api/tags/[id]",
          "method": "PATCH",
          "description": "Update tag",
          "requestSchema": "{ name?: string, color?: string }",
          "responseSchema": "{ tag: Tag }",
          "authentication": true,
          "relatedStories": [
            "TAG-003"
          ]
        },
        {
          "id": "api-tags-delete",
          "path": "/api/tags/[id]",
          "method": "DELETE",
          "description": "Delete tag",
          "requestSchema": "{ removeFromEntities?: boolean }",
          "responseSchema": "{ success: boolean, affectedCount: number }",
          "authentication": true,
          "relatedStories": [
            "TAG-004"
          ]
        },
        {
          "id": "api-tags-merge",
          "path": "/api/tags/merge",
          "method": "POST",
          "description": "Merge multiple tags into one",
          "requestSchema": "{ sourceTagIds: string[], targetTagId: string }",
          "responseSchema": "{ tag: Tag, mergedCount: number }",
          "authentication": true,
          "relatedStories": [
            "TAG-005"
          ]
        },
        {
          "id": "api-files-list",
          "path": "/api/files",
          "method": "GET",
          "description": "List files with filtering",
          "requestSchema": "{ page?: number, limit?: number, subjectType?: 'contact' | 'company' | 'deal', subjectId?: string, uploadedBy?: string, mimeType?: string }",
          "responseSchema": "{ files: File[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "FILE-001"
          ]
        },
        {
          "id": "api-files-upload",
          "path": "/api/files/upload",
          "method": "POST",
          "description": "Upload a file",
          "requestSchema": "FormData { file: Blob, subjectType?: 'contact' | 'company' | 'deal', subjectId?: string, description?: string }",
          "responseSchema": "{ file: File, uploadUrl: string }",
          "authentication": true,
          "relatedStories": [
            "FILE-002"
          ]
        },
        {
          "id": "api-files-get",
          "path": "/api/files/[id]",
          "method": "GET",
          "description": "Get file metadata",
          "requestSchema": "{}",
          "responseSchema": "{ file: File, downloadUrl: string }",
          "authentication": true,
          "relatedStories": [
            "FILE-003"
          ]
        },
        {
          "id": "api-files-download",
          "path": "/api/files/[id]/download",
          "method": "GET",
          "description": "Get signed download URL",
          "requestSchema": "{}",
          "responseSchema": "{ url: string, expiresAt: string }",
          "authentication": true,
          "relatedStories": [
            "FILE-004"
          ]
        },
        {
          "id": "api-files-delete",
          "path": "/api/files/[id]",
          "method": "DELETE",
          "description": "Delete file",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "FILE-005"
          ]
        },
        {
          "id": "api-files-profile-picture",
          "path": "/api/files/profile-picture",
          "method": "POST",
          "description": "Upload profile picture for contact",
          "requestSchema": "FormData { file: Blob, contactId: string }",
          "responseSchema": "{ contact: Contact, file: File }",
          "authentication": true,
          "relatedStories": [
            "FILE-006"
          ]
        },
        {
          "id": "api-custom-fields-list",
          "path": "/api/custom-fields",
          "method": "GET",
          "description": "List custom field definitions",
          "requestSchema": "{ entityType?: 'contact' | 'company' | 'deal' }",
          "responseSchema": "{ fields: CustomFieldDefinition[] }",
          "authentication": true,
          "relatedStories": [
            "CUSTOM-001"
          ]
        },
        {
          "id": "api-custom-fields-create",
          "path": "/api/custom-fields",
          "method": "POST",
          "description": "Create custom field definition",
          "requestSchema": "{ entityType: 'contact' | 'company' | 'deal', name: string, label: string, type: 'text' | 'number' | 'date' | 'select' | 'multiselect' | 'checkbox' | 'url' | 'email' | 'phone', required?: boolean, options?: string[], defaultValue?: any, order?: number }",
          "responseSchema": "{ field: CustomFieldDefinition }",
          "authentication": true,
          "relatedStories": [
            "CUSTOM-002"
          ]
        },
        {
          "id": "api-custom-fields-update",
          "path": "/api/custom-fields/[id]",
          "method": "PATCH",
          "description": "Update custom field definition",
          "requestSchema": "{ label?: string, required?: boolean, options?: string[], defaultValue?: any, order?: number }",
          "responseSchema": "{ field: CustomFieldDefinition }",
          "authentication": true,
          "relatedStories": [
            "CUSTOM-003"
          ]
        },
        {
          "id": "api-custom-fields-delete",
          "path": "/api/custom-fields/[id]",
          "method": "DELETE",
          "description": "Delete custom field definition",
          "requestSchema": "{ deleteValues?: boolean }",
          "responseSchema": "{ success: boolean, affectedEntities: number }",
          "authentication": true,
          "relatedStories": [
            "CUSTOM-004"
          ]
        },
        {
          "id": "api-custom-fields-reorder",
          "path": "/api/custom-fields/reorder",
          "method": "POST",
          "description": "Reorder custom fields",
          "requestSchema": "{ entityType: 'contact' | 'company' | 'deal', fieldOrders: { id: string, order: number }[] }",
          "responseSchema": "{ fields: CustomFieldDefinition[] }",
          "authentication": true,
          "relatedStories": [
            "CUSTOM-005"
          ]
        },
        {
          "id": "api-import-contacts",
          "path": "/api/import/contacts",
          "method": "POST",
          "description": "Start contact import job",
          "requestSchema": "FormData { file: Blob, mapping: Record<string, string>, duplicateHandling: 'skip' | 'update' | 'create_new', tagIds?: string[] }",
          "responseSchema": "{ job: ImportJob }",
          "authentication": true,
          "relatedStories": [
            "IMPORT-001"
          ]
        },
        {
          "id": "api-import-companies",
          "path": "/api/import/companies",
          "method": "POST",
          "description": "Start company import job",
          "requestSchema": "FormData { file: Blob, mapping: Record<string, string>, duplicateHandling: 'skip' | 'update' | 'create_new' }",
          "responseSchema": "{ job: ImportJob }",
          "authentication": true,
          "relatedStories": [
            "IMPORT-002"
          ]
        },
        {
          "id": "api-import-preview",
          "path": "/api/import/preview",
          "method": "POST",
          "description": "Preview import data and detect columns",
          "requestSchema": "FormData { file: Blob, entityType: 'contact' | 'company' }",
          "responseSchema": "{ columns: string[], sampleRows: Record<string, string>[], suggestedMapping: Record<string, string>, totalRows: number }",
          "authentication": true,
          "relatedStories": [
            "IMPORT-003"
          ]
        },
        {
          "id": "api-import-status",
          "path": "/api/import/[jobId]",
          "method": "GET",
          "description": "Get import job status",
          "requestSchema": "{}",
          "responseSchema": "{ job: ImportJob, progress: { processed: number, total: number, created: number, updated: number, skipped: number, errors: { row: number, error: string }[] } }",
          "authentication": true,
          "relatedStories": [
            "IMPORT-004"
          ]
        },
        {
          "id": "api-import-cancel",
          "path": "/api/import/[jobId]/cancel",
          "method": "POST",
          "description": "Cancel import job",
          "requestSchema": "{}",
          "responseSchema": "{ job: ImportJob }",
          "authentication": true,
          "relatedStories": [
            "IMPORT-005"
          ]
        },
        {
          "id": "api-export-contacts",
          "path": "/api/export/contacts",
          "method": "POST",
          "description": "Start contact export job",
          "requestSchema": "{ format: 'csv' | 'xlsx', filters?: { tags?: string[], companyId?: string, ownerId?: string, createdAfter?: string, createdBefore?: string }, columns?: string[], includeCustomFields?: boolean }",
          "responseSchema": "{ job: ExportJob }",
          "authentication": true,
          "relatedStories": [
            "EXPORT-001"
          ]
        },
        {
          "id": "api-export-companies",
          "path": "/api/export/companies",
          "method": "POST",
          "description": "Start company export job",
          "requestSchema": "{ format: 'csv' | 'xlsx', filters?: { industry?: string, tags?: string[] }, columns?: string[], includeCustomFields?: boolean }",
          "responseSchema": "{ job: ExportJob }",
          "authentication": true,
          "relatedStories": [
            "EXPORT-002"
          ]
        },
        {
          "id": "api-export-deals",
          "path": "/api/export/deals",
          "method": "POST",
          "description": "Start deal export job",
          "requestSchema": "{ format: 'csv' | 'xlsx', filters?: { pipelineId?: string, status?: string, ownerId?: string, closedAfter?: string, closedBefore?: string }, columns?: string[] }",
          "responseSchema": "{ job: ExportJob }",
          "authentication": true,
          "relatedStories": [
            "EXPORT-003"
          ]
        },
        {
          "id": "api-export-status",
          "path": "/api/export/[jobId]",
          "method": "GET",
          "description": "Get export job status",
          "requestSchema": "{}",
          "responseSchema": "{ job: ExportJob, progress: { processed: number, total: number }, downloadUrl?: string }",
          "authentication": true,
          "relatedStories": [
            "EXPORT-004"
          ]
        },
        {
          "id": "api-export-download",
          "path": "/api/export/[jobId]/download",
          "method": "GET",
          "description": "Download export file",
          "requestSchema": "{}",
          "responseSchema": "Binary file download",
          "authentication": true,
          "relatedStories": [
            "EXPORT-005"
          ]
        },
        {
          "id": "api-dashboard-overview",
          "path": "/api/dashboard/overview",
          "method": "GET",
          "description": "Get dashboard overview KPIs",
          "requestSchema": "{ period?: 'week' | 'month' | 'quarter' | 'year', teamId?: string }",
          "responseSchema": "{ dealsWon: { count: number, value: number, change: number }, dealsPipeline: { count: number, value: number }, activitiesLogged: { count: number, change: number }, conversionRate: { rate: number, change: number }, newContacts: { count: number, change: number } }",
          "authentication": true,
          "relatedStories": [
            "DASHBOARD-001"
          ]
        },
        {
          "id": "api-dashboard-pipeline-summary",
          "path": "/api/dashboard/pipeline-summary",
          "method": "GET",
          "description": "Get pipeline summary with stage breakdown",
          "requestSchema": "{ pipelineId?: string, teamId?: string }",
          "responseSchema": "{ stages: { stage: PipelineStage, dealCount: number, totalValue: number, avgAge: number }[], totalValue: number, weightedValue: number }",
          "authentication": true,
          "relatedStories": [
            "DASHBOARD-002"
          ]
        },
        {
          "id": "api-dashboard-sales-forecast",
          "path": "/api/dashboard/sales-forecast",
          "method": "GET",
          "description": "Get sales forecast vs actual",
          "requestSchema": "{ period?: 'month' | 'quarter' | 'year', teamId?: string }",
          "responseSchema": "{ forecast: { month: string, forecasted: number, actual: number, pipeline: number }[], accuracy: number }",
          "authentication": true,
          "relatedStories": [
            "DASHBOARD-003"
          ]
        },
        {
          "id": "api-dashboard-activity-summary",
          "path": "/api/dashboard/activity-summary",
          "method": "GET",
          "description": "Get activity summary by type and user",
          "requestSchema": "{ period?: 'week' | 'month', teamId?: string }",
          "responseSchema": "{ byType: { type: string, count: number }[], byUser: { user: User, calls: number, emails: number, meetings: number }[], trend: { date: string, count: number }[] }",
          "authentication": true,
          "relatedStories": [
            "DASHBOARD-004"
          ]
        },
        {
          "id": "api-dashboard-pipeline-velocity",
          "path": "/api/dashboard/pipeline-velocity",
          "method": "GET",
          "description": "Get pipeline velocity metrics",
          "requestSchema": "{ pipelineId?: string, period?: 'month' | 'quarter' }",
          "responseSchema": "{ avgDealCycle: number, avgTimePerStage: Record<string, number>, winRate: number, avgDealSize: number, velocity: number }",
          "authentication": true,
          "relatedStories": [
            "DASHBOARD-005"
          ]
        },
        {
          "id": "api-dashboard-win-loss-analysis",
          "path": "/api/dashboard/win-loss-analysis",
          "method": "GET",
          "description": "Get win/loss analysis",
          "requestSchema": "{ period?: 'month' | 'quarter' | 'year', pipelineId?: string }",
          "responseSchema": "{ winRate: number, lostReasons: { reason: string, count: number, value: number }[], competitors: { name: string, losses: number }[], trend: { month: string, wins: number, losses: number }[] }",
          "authentication": true,
          "relatedStories": [
            "DASHBOARD-006"
          ]
        },
        {
          "id": "api-reports-list",
          "path": "/api/reports",
          "method": "GET",
          "description": "List saved reports",
          "requestSchema": "{ type?: 'sales' | 'activity' | 'pipeline' | 'custom', ownerId?: string }",
          "responseSchema": "{ reports: SavedReport[] }",
          "authentication": true,
          "relatedStories": [
            "REPORT-001"
          ]
        },
        {
          "id": "api-reports-create",
          "path": "/api/reports",
          "method": "POST",
          "description": "Create saved report",
          "requestSchema": "{ name: string, type: 'sales' | 'activity' | 'pipeline' | 'custom', config: { entityType: string, columns: string[], filters: Record<string, any>, groupBy?: string, sortBy?: string, chartType?: string }, isShared?: boolean }",
          "responseSchema": "{ report: SavedReport }",
          "authentication": true,
          "relatedStories": [
            "REPORT-002"
          ]
        },
        {
          "id": "api-reports-get",
          "path": "/api/reports/[id]",
          "method": "GET",
          "description": "Get saved report with data",
          "requestSchema": "{ page?: number, limit?: number }",
          "responseSchema": "{ report: SavedReport, data: any[], total: number, summary?: Record<string, number> }",
          "authentication": true,
          "relatedStories": [
            "REPORT-003"
          ]
        },
        {
          "id": "api-reports-update",
          "path": "/api/reports/[id]",
          "method": "PATCH",
          "description": "Update saved report",
          "requestSchema": "{ name?: string, config?: object, isShared?: boolean }",
          "responseSchema": "{ report: SavedReport }",
          "authentication": true,
          "relatedStories": [
            "REPORT-004"
          ]
        },
        {
          "id": "api-reports-delete",
          "path": "/api/reports/[id]",
          "method": "DELETE",
          "description": "Delete saved report",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "REPORT-005"
          ]
        },
        {
          "id": "api-reports-export",
          "path": "/api/reports/[id]/export",
          "method": "POST",
          "description": "Export report to PDF or Excel",
          "requestSchema": "{ format: 'pdf' | 'xlsx' }",
          "responseSchema": "{ job: ExportJob }",
          "authentication": true,
          "relatedStories": [
            "REPORT-006"
          ]
        },
        {
          "id": "api-reports-run",
          "path": "/api/reports/run",
          "method": "POST",
          "description": "Run ad-hoc report without saving",
          "requestSchema": "{ entityType: string, columns: string[], filters: Record<string, any>, groupBy?: string, sortBy?: string, page?: number, limit?: number }",
          "responseSchema": "{ data: any[], total: number, summary?: Record<string, number> }",
          "authentication": true,
          "relatedStories": [
            "REPORT-007"
          ]
        },
        {
          "id": "api-filters-list",
          "path": "/api/filters",
          "method": "GET",
          "description": "List saved filters",
          "requestSchema": "{ entityType?: 'contact' | 'company' | 'deal' }",
          "responseSchema": "{ filters: SavedFilter[] }",
          "authentication": true,
          "relatedStories": [
            "FILTER-001"
          ]
        },
        {
          "id": "api-filters-create",
          "path": "/api/filters",
          "method": "POST",
          "description": "Create saved filter",
          "requestSchema": "{ name: string, entityType: 'contact' | 'company' | 'deal', conditions: { field: string, operator: string, value: any }[], isDefault?: boolean }",
          "responseSchema": "{ filter: SavedFilter }",
          "authentication": true,
          "relatedStories": [
            "FILTER-002"
          ]
        },
        {
          "id": "api-filters-update",
          "path": "/api/filters/[id]",
          "method": "PATCH",
          "description": "Update saved filter",
          "requestSchema": "{ name?: string, conditions?: object[], isDefault?: boolean }",
          "responseSchema": "{ filter: SavedFilter }",
          "authentication": true,
          "relatedStories": [
            "FILTER-003"
          ]
        },
        {
          "id": "api-filters-delete",
          "path": "/api/filters/[id]",
          "method": "DELETE",
          "description": "Delete saved filter",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "FILTER-004"
          ]
        },
        {
          "id": "api-assignment-rules-list",
          "path": "/api/assignment-rules",
          "method": "GET",
          "description": "List lead assignment rules",
          "requestSchema": "{}",
          "responseSchema": "{ rules: LeadAssignmentRule[] }",
          "authentication": true,
          "relatedStories": [
            "ASSIGN-001"
          ]
        },
        {
          "id": "api-assignment-rules-create",
          "path": "/api/assignment-rules",
          "method": "POST",
          "description": "Create lead assignment rule",
          "requestSchema": "{ name: string, type: 'round_robin' | 'territory' | 'criteria', priority: number, criteria?: { field: string, operator: string, value: any }[], assignees: string[], isActive?: boolean }",
          "responseSchema": "{ rule: LeadAssignmentRule }",
          "authentication": true,
          "relatedStories": [
            "ASSIGN-002"
          ]
        },
        {
          "id": "api-assignment-rules-update",
          "path": "/api/assignment-rules/[id]",
          "method": "PATCH",
          "description": "Update lead assignment rule",
          "requestSchema": "{ name?: string, priority?: number, criteria?: object[], assignees?: string[], isActive?: boolean }",
          "responseSchema": "{ rule: LeadAssignmentRule }",
          "authentication": true,
          "relatedStories": [
            "ASSIGN-003"
          ]
        },
        {
          "id": "api-assignment-rules-delete",
          "path": "/api/assignment-rules/[id]",
          "method": "DELETE",
          "description": "Delete lead assignment rule",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "ASSIGN-004"
          ]
        },
        {
          "id": "api-assignment-rules-reorder",
          "path": "/api/assignment-rules/reorder",
          "method": "POST",
          "description": "Reorder assignment rules priority",
          "requestSchema": "{ ruleOrders: { id: string, priority: number }[] }",
          "responseSchema": "{ rules: LeadAssignmentRule[] }",
          "authentication": true,
          "relatedStories": [
            "ASSIGN-005"
          ]
        },
        {
          "id": "api-assignment-rules-test",
          "path": "/api/assignment-rules/test",
          "method": "POST",
          "description": "Test assignment rules with sample data",
          "requestSchema": "{ contactData: Record<string, any> }",
          "responseSchema": "{ matchedRule: LeadAssignmentRule | null, assignedTo: User | null }",
          "authentication": true,
          "relatedStories": [
            "ASSIGN-006"
          ]
        },
        {
          "id": "api-notifications-list",
          "path": "/api/notifications",
          "method": "GET",
          "description": "List user notifications",
          "requestSchema": "{ page?: number, limit?: number, unreadOnly?: boolean }",
          "responseSchema": "{ notifications: Notification[], total: number, unreadCount: number }",
          "authentication": true,
          "relatedStories": [
            "NOTIF-001"
          ]
        },
        {
          "id": "api-notifications-mark-read",
          "path": "/api/notifications/[id]/read",
          "method": "POST",
          "description": "Mark notification as read",
          "requestSchema": "{}",
          "responseSchema": "{ notification: Notification }",
          "authentication": true,
          "relatedStories": [
            "NOTIF-002"
          ]
        },
        {
          "id": "api-notifications-mark-all-read",
          "path": "/api/notifications/mark-all-read",
          "method": "POST",
          "description": "Mark all notifications as read",
          "requestSchema": "{}",
          "responseSchema": "{ updatedCount: number }",
          "authentication": true,
          "relatedStories": [
            "NOTIF-003"
          ]
        },
        {
          "id": "api-notifications-preferences",
          "path": "/api/notifications/preferences",
          "method": "GET",
          "description": "Get notification preferences",
          "requestSchema": "{}",
          "responseSchema": "{ preferences: { type: string, email: boolean, inApp: boolean }[] }",
          "authentication": true,
          "relatedStories": [
            "NOTIF-004"
          ]
        },
        {
          "id": "api-notifications-preferences-update",
          "path": "/api/notifications/preferences",
          "method": "PUT",
          "description": "Update notification preferences",
          "requestSchema": "{ preferences: { type: string, email: boolean, inApp: boolean }[] }",
          "responseSchema": "{ preferences: { type: string, email: boolean, inApp: boolean }[] }",
          "authentication": true,
          "relatedStories": [
            "NOTIF-005"
          ]
        },
        {
          "id": "api-audit-logs-list",
          "path": "/api/audit-logs",
          "method": "GET",
          "description": "List audit logs",
          "requestSchema": "{ page?: number, limit?: number, entityType?: string, entityId?: string, userId?: string, action?: string, startDate?: string, endDate?: string }",
          "responseSchema": "{ logs: AuditLog[], total: number, page: number, totalPages: number }",
          "authentication": true,
          "relatedStories": [
            "AUDIT-001"
          ]
        },
        {
          "id": "api-audit-logs-entity",
          "path": "/api/audit-logs/entity/[entityType]/[entityId]",
          "method": "GET",
          "description": "Get audit logs for specific entity",
          "requestSchema": "{ page?: number, limit?: number }",
          "responseSchema": "{ logs: AuditLog[], total: number }",
          "authentication": true,
          "relatedStories": [
            "AUDIT-002"
          ]
        },
        {
          "id": "api-audit-logs-export",
          "path": "/api/audit-logs/export",
          "method": "POST",
          "description": "Export audit logs",
          "requestSchema": "{ format: 'csv' | 'json', filters: { startDate: string, endDate: string, entityType?: string, userId?: string } }",
          "responseSchema": "{ job: ExportJob }",
          "authentication": true,
          "relatedStories": [
            "AUDIT-003"
          ]
        },
        {
          "id": "api-gdpr-export-request",
          "path": "/api/gdpr/export-request",
          "method": "POST",
          "description": "Request GDPR data export for contact",
          "requestSchema": "{ contactId: string, reason?: string }",
          "responseSchema": "{ request: DataDeletionRequest, estimatedCompletion: string }",
          "authentication": true,
          "relatedStories": [
            "GDPR-001"
          ]
        },
        {
          "id": "api-gdpr-deletion-request",
          "path": "/api/gdpr/deletion-request",
          "method": "POST",
          "description": "Request GDPR data deletion for contact",
          "requestSchema": "{ contactId: string, reason: string, verificationMethod: string }",
          "responseSchema": "{ request: DataDeletionRequest, scheduledDate: string }",
          "authentication": true,
          "relatedStories": [
            "GDPR-002"
          ]
        },
        {
          "id": "api-gdpr-requests-list",
          "path": "/api/gdpr/requests",
          "method": "GET",
          "description": "List GDPR requests",
          "requestSchema": "{ page?: number, limit?: number, type?: 'export' | 'deletion', status?: string }",
          "responseSchema": "{ requests: DataDeletionRequest[], total: number }",
          "authentication": true,
          "relatedStories": [
            "GDPR-003"
          ]
        },
        {
          "id": "api-gdpr-request-status",
          "path": "/api/gdpr/requests/[id]",
          "method": "GET",
          "description": "Get GDPR request status",
          "requestSchema": "{}",
          "responseSchema": "{ request: DataDeletionRequest, downloadUrl?: string }",
          "authentication": true,
          "relatedStories": [
            "GDPR-004"
          ]
        },
        {
          "id": "api-organization-get",
          "path": "/api/organization",
          "method": "GET",
          "description": "Get current organization details",
          "requestSchema": "{}",
          "responseSchema": "{ organization: Organization, stats: { totalUsers: number, totalContacts: number, totalDeals: number } }",
          "authentication": true,
          "relatedStories": [
            "ORG-001"
          ]
        },
        {
          "id": "api-organization-update",
          "path": "/api/organization",
          "method": "PATCH",
          "description": "Update organization settings",
          "requestSchema": "{ name?: string, domain?: string, logo?: string, settings?: { timezone?: string, dateFormat?: string, currency?: string } }",
          "responseSchema": "{ organization: Organization }",
          "authentication": true,
          "relatedStories": [
            "ORG-002"
          ]
        },
        {
          "id": "api-organization-billing",
          "path": "/api/organization/billing",
          "method": "GET",
          "description": "Get organization billing information",
          "requestSchema": "{}",
          "responseSchema": "{ plan: string, seats: { used: number, total: number }, nextBillingDate: string, invoices: { id: string, date: string, amount: number }[] }",
          "authentication": true,
          "relatedStories": [
            "ORG-003"
          ]
        },
        {
          "id": "api-search-global",
          "path": "/api/search",
          "method": "GET",
          "description": "Global search across all entities",
          "requestSchema": "{ query: string, types?: ('contact' | 'company' | 'deal')[], limit?: number }",
          "responseSchema": "{ results: { type: string, id: string, title: string, subtitle: string, score: number }[], total: number }",
          "authentication": true,
          "relatedStories": [
            "SEARCH-001"
          ]
        },
        {
          "id": "api-search-contacts",
          "path": "/api/search/contacts",
          "method": "GET",
          "description": "Search contacts with autocomplete",
          "requestSchema": "{ query: string, limit?: number, excludeIds?: string[] }",
          "responseSchema": "{ contacts: { id: string, name: string, email: string, company: string }[] }",
          "authentication": true,
          "relatedStories": [
            "SEARCH-002"
          ]
        },
        {
          "id": "api-search-companies",
          "path": "/api/search/companies",
          "method": "GET",
          "description": "Search companies with autocomplete",
          "requestSchema": "{ query: string, limit?: number, excludeIds?: string[] }",
          "responseSchema": "{ companies: { id: string, name: string, domain: string }[] }",
          "authentication": true,
          "relatedStories": [
            "SEARCH-003"
          ]
        },
        {
          "id": "api-health",
          "path": "/api/health",
          "method": "GET",
          "description": "Health check endpoint",
          "requestSchema": "{}",
          "responseSchema": "{ status: 'healthy' | 'degraded' | 'unhealthy', version: string, timestamp: string, checks: { database: boolean, storage: boolean, cache: boolean } }",
          "authentication": false,
          "relatedStories": [
            "INFRA-001"
          ]
        },
        {
          "id": "api-scheduled-jobs-list",
          "path": "/api/admin/scheduled-jobs",
          "method": "GET",
          "description": "List scheduled background jobs",
          "requestSchema": "{ status?: 'pending' | 'running' | 'completed' | 'failed' }",
          "responseSchema": "{ jobs: ScheduledJob[] }",
          "authentication": true,
          "relatedStories": [
            "ADMIN-001"
          ]
        },
        {
          "id": "api-scheduled-jobs-retry",
          "path": "/api/admin/scheduled-jobs/[id]/retry",
          "method": "POST",
          "description": "Retry failed scheduled job",
          "requestSchema": "{}",
          "responseSchema": "{ job: ScheduledJob }",
          "authentication": true,
          "relatedStories": [
            "ADMIN-002"
          ]
        },
        {
          "id": "api-webhooks-list",
          "path": "/api/webhooks",
          "method": "GET",
          "description": "List configured webhooks",
          "requestSchema": "{}",
          "responseSchema": "{ webhooks: { id: string, url: string, events: string[], isActive: boolean }[] }",
          "authentication": true,
          "relatedStories": [
            "WEBHOOK-001"
          ]
        },
        {
          "id": "api-webhooks-create",
          "path": "/api/webhooks",
          "method": "POST",
          "description": "Create webhook subscription",
          "requestSchema": "{ url: string, events: string[], secret?: string }",
          "responseSchema": "{ webhook: { id: string, url: string, events: string[], secret: string } }",
          "authentication": true,
          "relatedStories": [
            "WEBHOOK-002"
          ]
        },
        {
          "id": "api-webhooks-update",
          "path": "/api/webhooks/[id]",
          "method": "PATCH",
          "description": "Update webhook subscription",
          "requestSchema": "{ url?: string, events?: string[], isActive?: boolean }",
          "responseSchema": "{ webhook: { id: string, url: string, events: string[], isActive: boolean } }",
          "authentication": true,
          "relatedStories": [
            "WEBHOOK-003"
          ]
        },
        {
          "id": "api-webhooks-delete",
          "path": "/api/webhooks/[id]",
          "method": "DELETE",
          "description": "Delete webhook subscription",
          "requestSchema": "{}",
          "responseSchema": "{ success: boolean }",
          "authentication": true,
          "relatedStories": [
            "WEBHOOK-004"
          ]
        },
        {
          "id": "api-webhooks-test",
          "path": "/api/webhooks/[id]/test",
          "method": "POST",
          "description": "Send test webhook payload",
          "requestSchema": "{ event: string }",
          "responseSchema": "{ success: boolean, responseCode: number, responseBody: string }",
          "authentication": true,
          "relatedStories": [
            "WEBHOOK-005"
          ]
        }
      ],
      "sharedUtilities": [
        {
          "name": "api-client",
          "path": "lib/api-client.ts",
          "purpose": "Centralized fetch wrapper with auth headers, error handling, and multi-tenant context injection",
          "interface": "export async function apiClient<T>(endpoint: string, options?: RequestInit): Promise<T>\nexport class ApiError extends Error { status: number; code: string; }"
        },
        {
          "name": "query-keys",
          "path": "lib/query-keys.ts",
          "purpose": "React Query key factory for consistent cache management across all entities",
          "interface": "export const queryKeys = {\n  contacts: { all: ['contacts'], list: (filters) => [...], detail: (id) => [...] },\n  companies: { ... },\n  deals: { ... },\n  activities: { ... },\n  tasks: { ... }\n}"
        },
        {
          "name": "format-date",
          "path": "lib/utils/format-date.ts",
          "purpose": "Date formatting and relative time utilities",
          "interface": "export function formatDate(date: Date | string, format?: string): string\nexport function formatRelativeTime(date: Date | string): string\nexport function formatDateRange(start: Date, end: Date): string"
        },
        {
          "name": "format-currency",
          "path": "lib/utils/format-currency.ts",
          "purpose": "Currency formatting for deal values and revenue tracking",
          "interface": "export function formatCurrency(amount: number, currency?: string, locale?: string): string\nexport function parseCurrency(value: string): number"
        },
        {
          "name": "validation-schemas",
          "path": "lib/validations/index.ts",
          "purpose": "Zod schemas for all entities shared between client and server",
          "interface": "export const contactSchema = z.object({...})\nexport const companySchema = z.object({...})\nexport const dealSchema = z.object({...})\nexport type Contact = z.infer<typeof contactSchema>"
        },
        {
          "name": "auth-context",
          "path": "lib/auth/auth-context.tsx",
          "purpose": "Authentication context providing user, organization, and permission info",
          "interface": "export function useAuth(): { user: User; organization: Organization; permissions: Permission[]; isLoading: boolean }\nexport function useRequireAuth(): void\nexport function usePermission(permission: string): boolean"
        },
        {
          "name": "tenant-context",
          "path": "lib/tenant/tenant-context.tsx",
          "purpose": "Multi-tenant context for organization isolation",
          "interface": "export function useTenant(): { organizationId: string; organizationName: string }\nexport function TenantProvider({ children }): JSX.Element"
        },
        {
          "name": "prisma-client",
          "path": "lib/db/prisma.ts",
          "purpose": "Singleton Prisma client with tenant middleware and soft-delete filtering",
          "interface": "export const prisma: PrismaClient\nexport function getTenantPrisma(organizationId: string): PrismaClient"
        },
        {
          "name": "api-response",
          "path": "lib/api/response.ts",
          "purpose": "Standardized API response helpers for consistent error handling",
          "interface": "export function successResponse<T>(data: T, status?: number): NextResponse\nexport function errorResponse(message: string, status: number, code?: string): NextResponse\nexport function paginatedResponse<T>(data: T[], total: number, page: number, limit: number): NextResponse"
        },
        {
          "name": "api-middleware",
          "path": "lib/api/middleware.ts",
          "purpose": "API route middleware for auth, tenant injection, and validation",
          "interface": "export function withAuth(handler: ApiHandler): ApiHandler\nexport function withTenant(handler: ApiHandler): ApiHandler\nexport function withValidation<T>(schema: ZodSchema<T>, handler: ApiHandler): ApiHandler"
        },
        {
          "name": "pagination",
          "path": "lib/utils/pagination.ts",
          "purpose": "Pagination utilities for list endpoints and UI components",
          "interface": "export function getPaginationParams(searchParams: URLSearchParams): { page: number; limit: number; offset: number }\nexport function buildPaginationMeta(total: number, page: number, limit: number): PaginationMeta"
        },
        {
          "name": "search-filter",
          "path": "lib/utils/search-filter.ts",
          "purpose": "Search and filter query building for Prisma",
          "interface": "export function buildSearchFilter(query: string, fields: string[]): Prisma.WhereInput\nexport function buildSortOrder(sortBy: string, sortOrder: 'asc' | 'desc'): Prisma.OrderByInput"
        },
        {
          "name": "audit-logger",
          "path": "lib/audit/audit-logger.ts",
          "purpose": "Audit trail logging for compliance tracking",
          "interface": "export async function logAuditEvent(params: { action: string; entityType: string; entityId: string; oldValues?: object; newValues?: object; userId: string; organizationId: string }): Promise<void>"
        },
        {
          "name": "custom-fields",
          "path": "lib/custom-fields/index.ts",
          "purpose": "Custom field validation and access utilities",
          "interface": "export function validateCustomFields(definitions: CustomFieldDefinition[], values: Record<string, unknown>): ValidationResult\nexport function getCustomFieldValue<T>(entity: { customFields: JsonValue }, fieldName: string): T | undefined"
        },
        {
          "name": "file-upload",
          "path": "lib/storage/file-upload.ts",
          "purpose": "S3/R2 file upload utilities with signed URL generation",
          "interface": "export async function uploadFile(file: File, folder: string): Promise<{ url: string; key: string }>\nexport async function getSignedUrl(key: string, expiresIn?: number): Promise<string>\nexport async function deleteFile(key: string): Promise<void>"
        },
        {
          "name": "toast-notifications",
          "path": "lib/utils/toast.ts",
          "purpose": "Toast notification utilities wrapping shadcn/ui toast",
          "interface": "export function showSuccess(message: string): void\nexport function showError(message: string): void\nexport function showLoading(message: string): { dismiss: () => void }"
        },
        {
          "name": "cn-classnames",
          "path": "lib/utils/cn.ts",
          "purpose": "Tailwind class merging utility",
          "interface": "export function cn(...inputs: ClassValue[]): string"
        }
      ],
      "implementationOrder": [
        "env-config-validation",
        "prisma-client-setup",
        "database-schema-migrations",
        "tenant-middleware",
        "soft-delete-middleware",
        "audit-logger",
        "nextauth-configuration",
        "auth-context-provider",
        "tenant-context-provider",
        "api-response-helpers",
        "api-middleware-chain",
        "validation-schemas-core",
        "query-keys-factory",
        "api-client",
        "root-layout-providers",
        "navigation-component",
        "sidebar-component",
        "user-api-routes",
        "team-api-routes",
        "organization-settings-api",
        "contact-schema-validation",
        "contact-api-routes",
        "contact-list-page",
        "contact-detail-page",
        "contact-form-component",
        "company-schema-validation",
        "company-api-routes",
        "company-list-page",
        "company-detail-page",
        "pipeline-configuration-api",
        "deal-schema-validation",
        "deal-api-routes",
        "deal-kanban-board",
        "deal-detail-page",
        "activity-schema-validation",
        "activity-api-routes",
        "activity-timeline-component",
        "task-schema-validation",
        "task-api-routes",
        "task-list-component",
        "task-form-component",
        "custom-field-definitions-api",
        "custom-field-renderer-component",
        "file-upload-api",
        "file-upload-component",
        "import-job-api",
        "import-wizard-component",
        "export-job-api",
        "export-builder-component",
        "dashboard-stats-api",
        "dashboard-page",
        "pipeline-analytics-api",
        "reports-api",
        "reports-builder-page",
        "notification-api",
        "notification-dropdown",
        "search-api-global",
        "search-command-palette",
        "user-management-page",
        "team-management-page",
        "role-permissions-page",
        "lead-assignment-rules-api",
        "gdpr-data-export-api",
        "gdpr-deletion-request-api"
      ],
      "criticalPaths": [
        "Prisma client with tenant middleware must be complete before any API routes - all data access depends on proper organization isolation",
        "NextAuth configuration and auth context are prerequisites for all protected routes and API endpoints",
        "API middleware chain (auth  tenant  validation) establishes security patterns used by every endpoint",
        "Validation schemas are shared between client forms and server validation - must be defined once and imported",
        "Contact and Company APIs must be complete before Deal APIs since deals reference both entities",
        "Activity and Task APIs depend on polymorphic association pattern working correctly with Contacts, Companies, and Deals",
        "Pipeline configuration must exist before Deal kanban board can render stages",
        "Custom field definitions API must be complete before custom field renderer component can display values",
        "File upload infrastructure required before profile pictures and document attachments work",
        "Dashboard and reports depend on all core entity APIs having proper aggregation queries",
        "Soft delete middleware must be tested thoroughly - incorrect filtering breaks data integrity",
        "Audit logging middleware must capture changes before any user-facing CRUD operations go live",
        "React Query provider setup determines all data fetching patterns - get cache settings right early",
        "Error handling patterns in api-client propagate to all features - establish toast notifications early"
      ],
      "diagrams": [
        {
          "id": "system-overview",
          "name": "System Overview",
          "type": "system",
          "format": "mermaid",
          "content": "graph TD\n    subgraph Client Layer\n        Browser[Browser Client]\n        Mobile[Mobile Browser]\n    end\n    \n    subgraph Next.js Application\n        AppRouter[App Router]\n        RSC[React Server Components]\n        ClientComp[Client Components]\n        APIRoutes[API Routes]\n    end\n    \n    subgraph Authentication\n        NextAuth[NextAuth.js]\n        GoogleOAuth[Google OAuth]\n        EmailAuth[Email/Password]\n    end\n    \n    subgraph Data Layer\n        Prisma[Prisma ORM]\n        RLS[Row Level Security]\n        PostgreSQL[(PostgreSQL)]\n    end\n    \n    subgraph External Services\n        S3[S3/Cloudflare R2]\n        BGJobs[Background Jobs]\n    end\n    \n    Browser --> AppRouter\n    Mobile --> AppRouter\n    AppRouter --> RSC\n    AppRouter --> ClientComp\n    RSC --> APIRoutes\n    ClientComp --> APIRoutes\n    APIRoutes --> NextAuth\n    NextAuth --> GoogleOAuth\n    NextAuth --> EmailAuth\n    APIRoutes --> Prisma\n    Prisma --> RLS\n    RLS --> PostgreSQL\n    APIRoutes --> S3\n    APIRoutes --> BGJobs",
          "description": "High-level system architecture showing client, Next.js application, authentication, data, and external service layers"
        },
        {
          "id": "component-hierarchy",
          "name": "Component Hierarchy",
          "type": "component",
          "format": "mermaid",
          "content": "graph TD\n    RootLayout[Root Layout]\n    \n    RootLayout --> AuthProvider[Auth Provider]\n    RootLayout --> QueryProvider[React Query Provider]\n    \n    AuthProvider --> AppShell[App Shell]\n    \n    AppShell --> Header[Header Component]\n    AppShell --> Sidebar[Sidebar Navigation]\n    AppShell --> MainContent[Main Content Area]\n    \n    Header --> UserMenu[User Menu]\n    Header --> SearchBar[Global Search]\n    Header --> Notifications[Notification Bell]\n    \n    Sidebar --> NavLinks[Navigation Links]\n    Sidebar --> TeamSelector[Team Selector]\n    \n    MainContent --> DashboardPage[Dashboard Page]\n    MainContent --> ContactsPage[Contacts Page]\n    MainContent --> CompaniesPage[Companies Page]\n    MainContent --> DealsPage[Deals Page]\n    MainContent --> TasksPage[Tasks Page]\n    MainContent --> ReportsPage[Reports Page]\n    MainContent --> SettingsPage[Settings Page]\n    \n    ContactsPage --> ContactList[Contact List]\n    ContactsPage --> ContactDetail[Contact Detail]\n    ContactsPage --> ContactForm[Contact Form]\n    \n    DealsPage --> PipelineBoard[Pipeline Kanban Board]\n    DealsPage --> DealDetail[Deal Detail]\n    DealsPage --> DealForm[Deal Form]\n    \n    DashboardPage --> KPICards[KPI Cards]\n    DashboardPage --> SalesChart[Sales Charts]\n    DashboardPage --> ActivityFeed[Activity Feed]\n    DashboardPage --> Leaderboard[Sales Leaderboard]",
          "description": "React component hierarchy showing layout structure and main page components"
        },
        {
          "id": "data-flow",
          "name": "Data Flow",
          "type": "sequence",
          "format": "mermaid",
          "content": "sequenceDiagram\n    participant U as User\n    participant UI as React Component\n    participant RQ as React Query\n    participant API as API Route\n    participant MW as Auth Middleware\n    participant PM as Prisma Middleware\n    participant DB as PostgreSQL\n    \n    U->>UI: User Action (e.g., Create Contact)\n    UI->>RQ: useMutation()\n    RQ->>API: POST /api/contacts\n    API->>MW: Validate Session\n    MW->>MW: Check RBAC Permissions\n    MW-->>API: Authorized\n    API->>PM: prisma.contact.create()\n    PM->>PM: Inject organizationId\n    PM->>PM: Log to AuditLog\n    PM->>DB: INSERT with RLS\n    DB-->>PM: New Contact Record\n    PM-->>API: Contact Object\n    API-->>RQ: JSON Response\n    RQ->>RQ: Update Cache\n    RQ-->>UI: Success + Data\n    UI-->>U: Show Success Toast",
          "description": "Data flow sequence showing a typical CRUD operation with authentication, multi-tenant isolation, and caching"
        },
        {
          "id": "er-diagram",
          "name": "Entity Relationships",
          "type": "er",
          "format": "mermaid",
          "content": "erDiagram\n    Organization ||--o{ User : has\n    Organization ||--o{ Team : has\n    Organization ||--o{ Contact : owns\n    Organization ||--o{ Company : owns\n    Organization ||--o{ Pipeline : configures\n    Organization ||--o{ CustomFieldDefinition : defines\n    \n    User ||--o{ Account : has\n    User ||--o{ Session : has\n    User ||--o{ TeamMembership : belongs_to\n    User ||--o{ Activity : performs\n    User ||--o{ Task : assigned\n    \n    Team ||--o{ TeamMembership : has\n    Team ||--o{ Pipeline : manages\n    \n    Contact ||--o{ ContactCompany : linked_via\n    Contact ||--o{ ContactTag : has\n    Contact ||--o{ Activity : subject_of\n    Contact ||--o{ Task : linked_to\n    Contact ||--o{ Note : has\n    Contact ||--o{ DealContact : participates_in\n    \n    Company ||--o{ ContactCompany : linked_via\n    Company ||--o{ CompanyTag : has\n    Company ||--o{ Deal : has\n    Company ||--o{ Activity : subject_of\n    Company }o--o| Company : parent_child\n    \n    Pipeline ||--o{ PipelineStage : has\n    PipelineStage ||--o{ Deal : contains\n    \n    Deal ||--o{ DealContact : involves\n    Deal ||--o{ DealTag : has\n    Deal ||--o{ DealStageHistory : tracks\n    Deal ||--o{ Activity : subject_of\n    Deal ||--o{ Task : linked_to\n    Deal ||--o{ File : has\n    \n    Tag ||--o{ ContactTag : applied_via\n    Tag ||--o{ CompanyTag : applied_via\n    Tag ||--o{ DealTag : applied_via",
          "description": "Database entity relationships showing core CRM data model with multi-tenant organization isolation"
        },
        {
          "id": "auth-flow",
          "name": "Authentication Flow",
          "type": "sequence",
          "format": "mermaid",
          "content": "sequenceDiagram\n    participant U as User\n    participant C as Client\n    participant NA as NextAuth\n    participant G as Google OAuth\n    participant DB as Database\n    \n    rect rgb(200, 220, 255)\n        Note over U,DB: Email/Password Registration\n        U->>C: Submit Registration Form\n        C->>NA: POST /api/auth/register\n        NA->>DB: Create User + Account\n        NA->>NA: Generate Verification Token\n        NA-->>U: Send Verification Email\n        U->>NA: Click Verification Link\n        NA->>DB: Mark Email Verified\n    end\n    \n    rect rgb(220, 255, 220)\n        Note over U,DB: Google OAuth Login\n        U->>C: Click Sign in with Google\n        C->>NA: Redirect to Google\n        NA->>G: OAuth Authorization\n        G-->>U: Consent Screen\n        U->>G: Grant Access\n        G-->>NA: Auth Code\n        NA->>G: Exchange for Tokens\n        G-->>NA: Access + ID Token\n        NA->>DB: Upsert User + Account\n        NA->>DB: Create Session\n        NA-->>C: Set Session Cookie\n    end\n    \n    rect rgb(255, 220, 220)\n        Note over U,DB: Session Validation\n        U->>C: Access Protected Page\n        C->>NA: Check Session\n        NA->>DB: Validate Session Token\n        DB-->>NA: User + Roles\n        NA-->>C: Session Valid\n        C-->>U: Render Page\n    end",
          "description": "Authentication flow showing email/password registration, Google OAuth, and session validation"
        },
        {
          "id": "pipeline-state",
          "name": "Deal Pipeline States",
          "type": "state",
          "format": "mermaid",
          "content": "stateDiagram-v2\n    [*] --> Lead: New Deal Created\n    \n    Lead --> Qualified: Qualify Lead\n    Lead --> Lost: Disqualify\n    \n    Qualified --> Proposal: Send Proposal\n    Qualified --> Lead: Needs More Info\n    Qualified --> Lost: Not a Fit\n    \n    Proposal --> Negotiation: Proposal Accepted\n    Proposal --> Qualified: Proposal Rejected\n    Proposal --> Lost: No Response\n    \n    Negotiation --> ClosedWon: Deal Signed\n    Negotiation --> Proposal: Revise Terms\n    Negotiation --> Lost: Deal Fell Through\n    \n    ClosedWon --> [*]: Complete\n    Lost --> [*]: Archive\n    \n    note right of Lead\n        Initial stage for all\n        new opportunities\n    end note\n    \n    note right of ClosedWon\n        Triggers revenue\n        recognition\n    end note\n    \n    note right of Lost\n        Captures loss reason\n        for analytics\n    end note",
          "description": "Deal pipeline state machine showing allowed transitions between stages"
        },
        {
          "id": "multi-tenant-architecture",
          "name": "Multi-Tenant Data Isolation",
          "type": "system",
          "format": "mermaid",
          "content": "graph TD\n    subgraph Request Flow\n        Request[Incoming Request]\n        AuthMW[Auth Middleware]\n        TenantMW[Tenant Context Middleware]\n    end\n    \n    subgraph Prisma Layer\n        PrismaClient[Prisma Client]\n        TenantMiddleware[Tenant Injection Middleware]\n        SoftDeleteMW[Soft Delete Filter]\n        AuditMW[Audit Trail Middleware]\n    end\n    \n    subgraph PostgreSQL\n        RLS[Row Level Security]\n        OrgTable[(Organizations)]\n        UserTable[(Users)]\n        ContactTable[(Contacts)]\n        CompanyTable[(Companies)]\n        DealTable[(Deals)]\n        AuditTable[(Audit Logs)]\n    end\n    \n    Request --> AuthMW\n    AuthMW -->|Extract User| TenantMW\n    TenantMW -->|Set organizationId| PrismaClient\n    \n    PrismaClient --> TenantMiddleware\n    TenantMiddleware -->|Auto-inject orgId| SoftDeleteMW\n    SoftDeleteMW -->|Filter deleted| AuditMW\n    AuditMW -->|Log changes| RLS\n    \n    RLS --> OrgTable\n    RLS --> UserTable\n    RLS --> ContactTable\n    RLS --> CompanyTable\n    RLS --> DealTable\n    AuditMW --> AuditTable\n    \n    style RLS fill:#ff9999\n    style TenantMiddleware fill:#99ff99\n    style AuditMW fill:#9999ff",
          "description": "Multi-tenant architecture showing how organization isolation is enforced at multiple layers"
        },
        {
          "id": "api-structure",
          "name": "API Route Structure",
          "type": "component",
          "format": "mermaid",
          "content": "graph LR\n    subgraph Auth Routes\n        AuthRegister[POST /api/auth/register]\n        AuthLogin[POST /api/auth/login]\n        AuthLogout[POST /api/auth/logout]\n        AuthRefresh[POST /api/auth/refresh]\n        AuthForgot[POST /api/auth/forgot-password]\n        AuthReset[POST /api/auth/reset-password]\n        AuthVerify[POST /api/auth/verify-email]\n        AuthGoogle[POST /api/auth/google]\n        AuthMe[GET /api/auth/me]\n        AuthPassword[POST /api/auth/change-password]\n    end\n    \n    subgraph CRM Routes\n        Contacts[/api/contacts]\n        Companies[/api/companies]\n        Deals[/api/deals]\n        Pipelines[/api/pipelines]\n        Tasks[/api/tasks]\n        Activities[/api/activities]\n        Notes[/api/notes]\n        Tags[/api/tags]\n    end\n    \n    subgraph Admin Routes\n        Users[/api/users]\n        Teams[/api/teams]\n        CustomFields[/api/custom-fields]\n        ImportExport[/api/import-export]\n    end\n    \n    subgraph Reporting Routes\n        Dashboard[/api/dashboard]\n        Reports[/api/reports]\n        Analytics[/api/analytics]\n    end\n    \n    subgraph File Routes\n        Files[/api/files]\n        Upload[POST /api/files/upload]\n        SignedURL[GET /api/files/signed-url]\n    end",
          "description": "API route structure organized by domain"
        }
      ]
    }
  },
  "epics": [],
  "stories": [],
  "domains": [],
  "squads": []
}